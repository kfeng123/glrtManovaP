\documentclass[10pt]{book}
\usepackage[sectionbib]{natbib}
\usepackage{array,epsfig,fancyheadings,rotating}
%\usepackage[dvipdfm]{hyperref}
\usepackage{hyperref}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\textwidth=31.9pc
\textheight=46.5pc
\oddsidemargin=1pc
\evensidemargin=1pc
\headsep=15pt
%\headheight=.2cm
\topmargin=.6cm
\parindent=1.7pc
\parskip=0pt


\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{amsthm}
\setcounter{page}{1}
\newtheorem{theorem}{Theorem}
\newtheorem{lemma}{Lemma}
\newtheorem{corollary}{Corollary}
\newtheorem{proposition}{Proposition}
\theoremstyle{definition}
\newtheorem{definition}{Definition}
%\newtheorem{proof}{Proof}
\newtheorem{example}{Example}
\newtheorem{remark}{Remark}
\pagestyle{fancy}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\pagestyle{fancy}
\def\n{\noindent}
\lhead[\fancyplain{} \leftmark]{}
\chead[]{}
\rhead[]{\fancyplain{}\rightmark}
\cfoot{}
%\headrulewidth=0pt

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{bm}
\usepackage{graphicx}
\usepackage{color}
%\usepackage{booktabs}
\usepackage{algorithm}
\usepackage{algorithmic}
\usepackage{IEEEtrantools}
\usepackage{enumerate}



\usepackage{xr}
\externaldocument{main}
%\usepackage{refcheck}


\DeclareMathOperator{\mytr}{tr}
\DeclareMathOperator{\mydiag}{diag}
\DeclareMathOperator{\myrank}{Rank}
\DeclareMathOperator{\myE}{E}
\DeclareMathOperator{\myVar}{Var}
\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}

\newcommand{\bQ}{\mathbf{Q}}
\newcommand{\bM}{\mathbf{M}}
\newcommand{\bZ}{\mathbf{Z}}
\newcommand{\bA}{\mathbf{A}}
\newcommand{\bB}{\mathbf{B}}
\newcommand{\bE}{\mathbf{E}}
\newcommand{\bF}{\mathbf{F}}
\newcommand{\bX}{\mathbf{X}}
\newcommand{\bP}{\mathbf{P}}
\newcommand{\bY}{\mathbf{Y}}
\newcommand{\bH}{\mathbf{H}}
\newcommand{\bG}{\mathbf{G}}
\newcommand{\bJ}{\mathbf{J}}
\newcommand{\bC}{\mathbf{C}}
\newcommand{\bO}{\mathbf{O}}
\newcommand{\bR}{\mathbf{R}}
\newcommand{\bI}{\mathbf{I}}
\newcommand{\bU}{\mathbf{U}}
\newcommand{\bD}{\mathbf{D}}
\newcommand{\bV}{\mathbf{V}}
\newcommand{\bW}{\mathbf{W}}
\newcommand{\bL}{\mathbf{L}}

\newcommand{\bu}{\mathbf{u}}
\newcommand{\bw}{\mathbf{w}}

\newcommand{\ud}{\mathbf{d}}

\newcommand{\bfsym}[1]{\ensuremath{\boldsymbol{#1}}}
\def\blambda {\bfsym {\lambda}} 
\def\bLambda {\bfsym {\Lambda}} 
\def\bSigma {\bfsym {\Sigma}} 
\def\bTheta {\bfsym {\Theta}} 
\def\bPsi {\bfsym {\Psi}} 


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}
\renewcommand{\baselinestretch}{2}

\markright{ \hbox{\footnotesize\rm Statistica Sinica: Supplement
%{\footnotesize\bf 24} (201?), 000-000
}\hfill\\[-13pt]
\hbox{\footnotesize\rm
%\href{http://dx.doi.org/10.5705/ss.20??.???}{doi:http://dx.doi.org/10.5705/ss.20??.???}
}\hfill }

\markboth{\hfill{\footnotesize\rm Rui Wang AND Xingzhong Xu} \hfill}
{\hfill {\footnotesize\rm Least Favorable Direction Test} \hfill}

\renewcommand{\thefootnote}{}
$\ $\par \fontsize{12}{14pt plus.8pt minus .6pt}\selectfont

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

 \centerline{\large\bf Least Favorable Direction Test for }
\vspace{2pt}
 \centerline{\large\bf Multivariate Analysis of Variance}
\vspace{2pt}
 \centerline{\large\bf in High Dimension}
\vspace{.25cm}
 \author{Rui Wang, Xingzhong Xu}
\vspace{.4cm}
 \centerline{\it Beijing Institute of Technology}
\vspace{.55cm}
 \centerline{\bf Supplementary Material}
\vspace{.55cm}
\fontsize{9}{11.5pt plus.8pt minus .6pt}\selectfont
\noindent
This file contains the technical proofs of Theorems.
\par

\setcounter{section}{0}
\setcounter{equation}{0}
\def\theequation{S\arabic{section}.\arabic{equation}}
\def\thesection{S\arabic{section}}

\fontsize{12}{14pt plus.8pt minus .6pt}\selectfont

\section{Title of section 1}

CONTENT OF THIS SECTION........\\
CONTENT OF THIS SECTION.\\
CONTENT OF THIS SECTION.\\
\par
\begin{equation}
\mbox {The 1st display equation of section 1.}
\end{equation}

\begin{equation}
\mbox {The 2nd display equation of section 1.}
\end{equation}

\section{Title of section 2}
\setcounter{equation}{0}

CONTENT OF THIS SECTION........\\
CONTENT OF THIS SECTION.\\
CONTENT OF THIS SECTION.\\
\par

\begin{equation}
\mbox {The 1st display equation of S.2.}
\end{equation}

\begin{equation}
\mbox {The 2nd display equation of S.2.}
\end{equation}

\newpage
\lhead[\footnotesize\thepage\fancyplain{}\leftmark]{}\rhead[]{\fancyplain{}\rightmark\footnotesize\thepage}%Put this line in Page 2








\section{Technical lemmas}
\setcounter{equation}{0}
\begin{lemma}\label{optProp}
    Suppose $\bA$ is a $p\times r$ matrix with rank $r$ and $\bB$ is a $p\times p$  non-zero positive semi-definite matrix.
    Denote by $\bA=\bU_\bA \bD_\bA \bV_\bA^\top$ the singular value decomposition of $\bA$, where $\bU_\bA$ and $\bV_\bA$ are $p\times r$ and $r\times r$ column orthogonal matrices, respectively, and $\bD_\bA$ is a $r\times r$ diagonal matrix.
    Let $\bP_\bA=\bU_\bA \bU_\bA^\top$ be the projection matrix onto the column space of $\bA$.
    Then
    \begin{equation*}
        \max_{a^\top a=1, a^\top \bA \bA^\top a=0}a^\top \bB a=
        \lambda_{1}\big(\bB(\bI_p-\bP_\bA)\big).
    \end{equation*}
\end{lemma}
\begin{proof}
    It can be seen that $a^\top \bA \bA^\top a=0$ if and only if $a= (\bI_p-\bP_\bA)a$.
    Then
    \begin{equation}\label{eq:prop1eq1}
        \begin{aligned}
        \max_{a^\top a=1, a^\top \bA \bA^\top a=0}a^\top \bB a
            &=
        \max_{a^\top a=1, \bP_\bA a=0}a^\top(\bI_p-\bP_\bA) \bB (\bI_p-\bP_\bA)a,
        \end{aligned}
    \end{equation}
    which is obviously no greater than $\lambda_1 \big((\bI-\bP_\bA)\bB(\bI-\bP_\bA)\big)$.
    To prove that they are equal,  without loss of generality, we can assume $\lambda_{1}\big((\bI-\bP_\bA)\bB(\bI-\bP_\bA)\big)>0$.
    Let $\alpha_1$ be one eigenvector corresponding to the largest eigenvalue of $(\bI-\bP_\bA)\bB(\bI-\bP_\bA)$.
    Since $(\bI-\bP_\bA)\bB(\bI-\bP_\bA)\bP_\bA=(\bI-\bP_\bA)\bB(\bP_\bA-\bP_\bA)=\bO_{p\times p}$ and $\bP_\bA$ is symmetric, the rows of $\bP_\bA$ are eigenvetors of $(\bI-\bP_\bA)\bB(\bI-\bP_\bA)$ corresponding to eigenvalue $0$.
    It follows that $\bP_\bA\alpha_1=0$.
    Therefore, $\alpha_1$ satisfies the constraint of~\eqref{eq:prop1eq1} and thus~\eqref{eq:prop1eq1} is no less than $\lambda_{1}\big((\bI-\bP_\bA)\bB(\bI-\bP_\bA)\big)$.
    The conclusion now follows by noting that $\lambda_{1}\big((\bI-\bP_\bA)\bB(\bI-\bP_\bA)\big)=\lambda_{1}\big( \bB(\bI-\bP_\bA)\big)$.
    
\end{proof}

\begin{lemma}
    Let $\xi_{n,i}$, $i=1,\ldots, n$, $n=1,2,\ldots$, be iid $s$-dimensional random vectors with mean zero, covariance matrix $\bM$ and finite fourth moment.
    For $n=1,2,\ldots$, let $\{a_{n,i}\}_{i=1}^n$ be real random variables which are independent of $\{\xi_{n,i}\}_{i=1}^n$ and satisfy 
    \begin{equation}\label{lycon}
        \frac{\max_{1\leq i\leq n}a_{n,i}^2}{\sum_{i=1}^n a_{n,i}^2}\xrightarrow{P}0.
    \end{equation}
    Then
    \begin{equation*}
    (\sum_{i=1}^n a_{n,i}^2)^{-1/2}\sum_{i=1}^n a_{n,i}\xi_{n,i} 
    \xrightarrow{\mathcal{L}}\mathcal{N}_s(\mathbf{0}_s,\bM).
    \end{equation*}
    \label{CLTLEMMA}
\end{lemma}
\begin{proof}
    First we observe that if $\{a_{n,i}\}_{i=1}^n$ are fixed numbers satisfying~\eqref{lycon}, then Lyapunov central limit theorem and continuity theorem imply that 
    for any $t\in\mathbb{R}^s$,
    \begin{equation*}
        \myE\left[\exp\left(
    (\sum_{i=1}^n a_{n,i}^2)^{-1/2}\sum_{i=1}^n a_{n,i}it^\top \xi_{n,i} 
    \right)\right]
    \to
    \exp\left(-\frac{1}{2} t^\top \bM t\right).
    \end{equation*}

    We only need to prove that for every subsequence of $\{n\}$, there is a further subsequence along which the conclusion holds.
    Let $\{m(n)\}$  be a subsequence of $\{n\}$.
    We can find a further subsequence of $\{m(n)\}$ along which~\eqref{lycon} holds almost surely.
    Then along this subsequence, our previous argument implies that
    for any $t\in\mathbb{R}^s$,
    \begin{equation*}
        \myE
       \left[ 
        \exp\left(
    (\sum_{i=1}^n a_{n,i}^2)^{-1/2}\sum_{i=1}^n a_{n,i}it^\top \xi_{n,i} 
    \right)
    \bigg| a_{n,1},\ldots, a_{n,n}
\right]
    \to
    \exp\left(-\frac{1}{2} t^\top \bM t\right)
    \end{equation*}
    almost surely.
    Then by dominated convergence theorem, we have
    \begin{equation*}
        \myE
       \left[ 
        \exp\left(
    (\sum_{i=1}^n a_{n,i}^2)^{-1/2}\sum_{i=1}^n a_{n,i}it^\top \xi_{n,i} 
    \right)
\right]
    \to
    \exp\left(-\frac{1}{2} t^\top \bM t\right)
    \end{equation*}
    along this further subsequence. This implies the conclusion holds along this further subsequence, which completes the proof.




 
\end{proof}

    \begin{lemma}[Weyl's inequality]
        Let $\bA$ and $\bB$ be two symmetric $n\times n$ matrices. If $r+s-1\leq i \leq j+k-n$, we have
        $$
        \lambda_j(\bA) +\lambda_k(\bB)\leq \lambda_i (\bA+\bB) \leq
        \lambda_r(\bA)+\lambda_s(\bB).
        $$
        See, for example,~\citet{Horn1985Matrix} Theorem 4.3.1.
\end{lemma}
\begin{lemma}[von Neumann's trace theorem]
    Let $\bA$ and $\bB$ be two $m\times n$ matrices. Let $\sigma_1(\bA)\geq \ldots \geq \sigma_q (\bA)$ and $\sigma_1(\bB)\geq \cdots \geq \sigma_q (\bB)$ denote the non-increasingly ordered singular values of $\bA$ and $\bB$, respectively. Then
    \begin{equation*}
        \mytr(\bA \bB^\top)\leq \sum_{i=1}^{\min(m,n)}\sigma_i(\bA)\sigma_i(\bB).
    \end{equation*}
    See, for example,~\citet{Horn1985Matrix} Theorem 7.4.1.1.
\end{lemma}
%\begin{lemma}[\citet{DAVIDSON2001317} Theorem II.7]\label{DSbound}
    %Let $\bA$ be $m\times n$ random matrix with iid $\mathcal{N}(0,1)$ entries.
    %If $m>n$, then for any $t>0$,
    %\begin{align*}
        %\Pr(\sqrt{\lambda_1(\bA \bA^\top)}>\sqrt{m}+\sqrt{n}+t)\leq \exp(-t^2/2),\\
        %\Pr(\sqrt{\lambda_n(\bA \bA^\top)}<\sqrt{m}-\sqrt{n}-t)\leq \exp(-t^2/2).
    %\end{align*}
%\end{lemma}

\begin{lemma}\label{lemma:con}
    Let $\{Z_i\}_{i=1}^n$ be iid $m$-dimensional random vectors with common distribution $\mathcal{N}_m(\mathbf{0}_m,\bI_m)$.
    Then for any $n$-dimensional vector $\omega=(\omega_1,\ldots,\omega_n)^\top$, we have
\begin{equation*}
    \left\|\sum_{i=1}^n \omega_i(Z_i Z_i^\top - \bI_m)\right\|=O_P(|\omega|_2 \sqrt{m}+|\omega|_{\infty}m),
\end{equation*}
where $|\omega|_2=\sqrt{\sum_{i=1}^n \omega_i^2}$ and $|\omega|_{\infty}=\max_{1\leq i\leq n}|\omega_i|$.
\end{lemma}
\begin{remark}
    Our proof implies that the conclusion is still valid if $\omega$ is random and is independent of $\{Z_i\}_{i=1}^n$.
\end{remark}
\begin{proof}
    Our proof is adapted from the proof of Theorem 5.39 in~\cite{Vershynin2010Introduction}.
    By Lemma 5.2 and Lemma 5.4 of~\cite{Vershynin2010Introduction}, there exists a set $\mathcal{C}\subset \{x\in\mathbb{R}^m: |x|_2=1\}$ satisfying $\text{Card} (\mathcal{C})\leq 9^m$ such that for any $m\times m$ symmetric matrix $\bA$,
    \begin{equation}\label{eq:b1}
    \|A\|\leq 2\max_{x\in\mathcal{C}} \left| x^\top \bA x \right|.
\end{equation}
Then for $t>4$, 
\begin{equation*}
    \begin{split}
        &\Pr\left(
            \left\|\sum_{i=1}^n \omega_i(Z_i Z_i^\top - \bI_m)\right\|
            > t (|\omega|_2 \sqrt{m}+|\omega|_{\infty} m)
        \right)
        \\
        \leq &
        \Pr\left(
            2\max_{x\in\mathcal{C}}\left|\sum_{i=1}^n \omega_i(x^\top Z_i Z_i^\top x - 1)\right|
            > t (|\omega|_2 \sqrt{m}+|\omega|_{\infty} m)
        \right)
        \\
        \leq &
        \sum_{x\in\mathcal{C}}
        \Pr\left(
            \left|\sum_{i=1}^n \omega_i(x^\top Z_i Z_i^\top x - 1)\right|
            >  2 |\omega|_2 \sqrt{\frac{mt}{4}}+2|\omega|_{\infty} \frac{mt}{4}
        \right)
        \\
        \leq & 2\cdot 9^{m} \exp\left(-\frac{mt}{4}\right)
        =2\exp\left((2\log 3 -t/4)m\right)
        ,
    \end{split}
\end{equation*}
where the first inequality follows from~\eqref{eq:b1}, the second inequality follows from the union bound and the third inequality follows Lemma 1 of~\cite{Laurent2000Adaptive}.
The upper bound $2\exp\left((2\log 3 -t/4)m\right)$ can be arbitrarily small as long as $t$ is large enough.
This completes the proof.
\end{proof}


%\section{Proofs of Propositions \ref{eigenvalueProp}-\ref{eigenvectorprop3}}
\section{Proofs of Propositions 1-4}
\setcounter{equation}{0}

\begin{proof}[\textbf{Proof of Proposition~\ref{eigenvalueProp}}]
    We only need to deal with the matrix $n^{-1}\bZ^\top \bLambda \bZ$ since it shares the same non-zero eigenvalues as $\hat{\bSigma}$.
    Write
    \begin{equation*}
        \begin{split}
        n^{-1}\bZ^\top \bLambda \bZ=&
        n^{-1}\bZ_1^\top \bLambda_1 \bZ_1+
        n^{-1}\bZ_2^\top \bLambda_2 \bZ_2
        \\
        =&
        n^{-1}\bZ_1^\top \bLambda_1 \bZ_1+
        n^{-1}\mytr(\bLambda_2)\bI_n+
        n^{-1}\left(\bZ_2^\top \bLambda_2 \bZ_2-\mytr(\bLambda_2)\bI_n\right)
        .
        \end{split}
    \end{equation*}
    Then Weyl's inequality implies that for $ i=1,\ldots, r$,
    \begin{equation}\label{eigenBoundForF}
        \begin{split}
        &
        \left|
        \lambda_i\left(n^{-1}\bZ^\top \bLambda \bZ\right)
        -
        \lambda_i(n^{-1}\bZ_1^\top \bLambda_1 \bZ_1)
        -
        n^{-1}
        \mytr(\bLambda_2)
        \right|
        \leq
        n^{-1}\left\|\bZ_2^\top \bLambda_2 \bZ_2-
        \mytr(\bLambda_2)
        \bI_n\right\|.
        \end{split}
    \end{equation}
    Using Weyl's inequality, we can derive the following lower bound for $\lambda_i(\bZ_1^\top \bLambda_1 \bZ_1)$, $ i=1,\ldots, r$.
\begin{equation*}
\begin{aligned}
\lambda_i(\bZ_1^\top \bLambda_1 \bZ_1)
\geq&
\lambda_i(\bZ_1^\top \mydiag(\blambda_i \bI_{i},\bO_{(r-i)\times(r-i)}) \bZ_1)
\\
    =&
    \lambda_i\Big( \blambda_i \bZ_1^\top \bZ_1-\blambda_i\bZ_1^\top \mydiag(\bO_{i\times i}, \bI_{r-i}) \bZ_1\Big)\\
    \geq&
    \lambda_r\Big( \blambda_i \bZ_1^\top \bZ_1\Big)+\lambda_{n+i-r}\Big(-\blambda_i\bZ_1^\top \mydiag(\bO_{i\times i}, \bI_{r-i}) \bZ_1\Big)\\
= &
\blambda_i \lambda_r(\bZ_1\bZ_1^\top).
\end{aligned}
\end{equation*}
Similarly, we can derive the following upper bound for
$\lambda_i(\bZ_1^\top \bLambda_1 \bZ_1)$, $i=1,\ldots,r$.
\begin{equation*}
\begin{aligned}
&\lambda_i(\bZ_1^\top \bLambda_1 \bZ_1)
\\
=&\lambda_i\Big(
\bZ_1^\top \big(
\mydiag(\blambda_1,\ldots,\blambda_{i-1},\bO_{(r-i+1)\times(r-i+1)})+
\mydiag(\bO_{(i-1)\times(i-1)},\blambda_i,\ldots,\blambda_r)
\big)
\bZ_1
\Big)\\
\leq&\lambda_i\Big(
\bZ_1^\top \big(
\mydiag(\blambda_1,\ldots,\blambda_{i-1},\bO_{(r-i+1)\times(r-i+1)})
\Big)
+
\lambda_1\Big(
\mydiag(\bO_{(i-1)\times(i-1)},\blambda_i,\ldots,\blambda_r)
\big)
\bZ_1
\Big)\\
%\leq&
%\lambda_1(\bZ_{1[1:r,:]}^\top \mydiag(\bO_{(i-1)\times(i-1)},\lambda_i,\ldots,\lambda_r) \bZ_{1[1:r,:]})
    \leq&
\lambda_1(\bZ_1^\top \mydiag(\bO_{(i-1)\times(i-1)},\blambda_i \bI_{r-i+1}) \bZ_1)
\leq  \blambda_i \lambda_1(\bZ_1\bZ_1^\top).
\end{aligned}
\end{equation*}
The above lower bound and upper bound imply
\begin{equation}\label{eigenBoundForA}
    \begin{aligned}
\left|
\lambda_i(n^{-1}\bZ_1^\top \bLambda_1 \bZ_1)-\blambda_i
\right|
\leq&
\blambda_i 
\max\left(
    |\lambda_1(n^{-1}\bZ_1 \bZ_1^\top)-1|,
    |\lambda_r(n^{-1}\bZ_1 \bZ_1^\top)-1|
\right)
\\
=&\blambda_i \|n^{-1}\bZ_1\bZ_1^\top -\bI_r\|.
    \end{aligned}
\end{equation}
Combining the bounds~\eqref{eigenBoundForF} and~\eqref{eigenBoundForA} gives that for $i=1,\ldots,r$,
\begin{equation*}
    \begin{split}
        &
        \left|
        \lambda_i\left(n^{-1}\bZ^\top \bLambda \bZ\right)
        -
        \blambda_i
        -
        n^{-1}\mytr(\bLambda_2)
        \right|
        \\
        \leq&
        n^{-1}\left\|\bZ_2^\top \bLambda_2 \bZ_2-\mytr(\bLambda_2) \bI_n\right\|
        +\blambda_i \|n^{-1}\bZ_1\bZ_1^\top -\bI_r\|.
    \end{split}
\end{equation*}
From Lemma~\ref{lemma:con}, we have
\begin{align}
    \label{conB2B1}
            \|n^{-1}\bZ_1\bZ_1^\top -\bI_r\|&=
            O_P\left(\sqrt{\frac{r}{n}}\right),
        \\
        \label{conB2B}
        n^{-1}\left\|\bZ_2^\top \bLambda_2 \bZ_2-\mytr(\bLambda_2)\bI_n\right\|&=O_P\left(\sqrt{\frac{\mytr(\bLambda_2^2)}{ n}}+\blambda_{r+1}\right).
\end{align}
This proves the first statement.

Next we prove the second statement. Note that
\begin{equation*}
    \begin{split}
     \sum_{i=r+1}^n\lambda_i(\hat{\bSigma})
    =&
    \sum_{i=r+1}^n\lambda_i(n^{-1}\ \bZ^\top \bLambda \bZ)
    \\
    =&
    \mytr (n^{-1}\bZ^\top \bLambda \bZ) -\sum_{i=1}^r\lambda_i(n^{-1}\ \bZ^\top \bLambda \bZ)
    \\
    =&
    \mytr (n^{-1}\bZ_2^\top \bLambda_2 \bZ_2)
    -\frac{r}{n} \mytr(\bLambda_2)
    \\
    &-
    \left(
    \sum_{i=1}^r\lambda_i(n^{-1}\ \bZ^\top \bLambda \bZ)
    -
    \mytr (n^{-1}\bZ_1^\top \bLambda_1 \bZ_1)
    -\frac{r}{n} \mytr(\bLambda_2)
\right)
    .
    \end{split}
\end{equation*}
It follows from inequalities~\eqref{eigenBoundForF} and~\eqref{conB2B} that
\begin{equation*}
    \begin{split}
    &\left|
    \sum_{i=1}^r\lambda_i(n^{-1}\ \bZ^\top \bLambda \bZ)
    -\mytr (n^{-1}\bZ_1^\top \bLambda_1 \bZ_1)- 
    \frac{r}{n}\mytr(\bLambda_2)
    \right|
    \\
    \leq & \frac{r}{n}
    \left\|\bZ_2^\top \bLambda_2 \bZ_2-\mytr(\bLambda_2)\bI_n\right\|
    =
    O_P\left(
    r\sqrt{\frac{\mytr(\bLambda_2^2)}{ n}}+r\blambda_{r+1}
    \right)
    .
    \end{split}
\end{equation*}
Thus,
\begin{equation*}
        \sum_{i=r+1}^n\lambda_i(\hat{\bSigma})
    =
    \mytr (n^{-1}\bZ_2^\top \bLambda_2 \bZ_2)
    -
    \frac{r}{n}\mytr(\bLambda_2)
    +O_P\left(
    r\sqrt{\frac{\mytr(\bLambda_2^2)}{ n}}+r\blambda_{r+1}
    \right)
    .
\end{equation*}
It is straightforward to show that
\begin{equation*}
    \myE \mytr (n^{-1}\bZ_2^\top \bLambda_2 \bZ_2)=\mytr(\bLambda_2),
    \quad
    \myVar \left(\mytr (n^{-1}\bZ_2^\top \bLambda_2 \bZ_2)\right)
    =\frac{2}{n}\mytr(\bLambda_2^2).
\end{equation*}
Hence
\begin{equation*}
    \begin{split}
     &\sum_{i=r+1}^n\lambda_i(\hat \bSigma)
     \\
    =&
\mytr(\bLambda_2)+O_P\left(\sqrt{\frac{\mytr(\bLambda_2^2)}{ n}}\right)
    -
    \frac{r}{n}\mytr(\bLambda_2)
    +O_P\left(
    r\sqrt{\frac{\mytr(\bLambda_2^2)}{ n}}+r\blambda_{r+1}
\right)
     \\
    =&
\mytr(\bLambda_2)
    -
    \frac{r}{n}\mytr(\bLambda_2)
    +O_P\left(
    r\sqrt{\frac{\mytr(\bLambda_2^2)}{ n}}+r\blambda_{r+1}
\right)
    .
    \end{split}
\end{equation*}
This completes the proof of the second statement.
\end{proof}

\begin{proof}[\textbf{Proof of Proposition~\ref{eigenvalueProp:R3}}]
    The first two statements are direct consequences of Proposition~\ref{eigenvalueProp} and the condition $r=o(n)$.
    Next we prove the third statement.
    We have
        $
        \widehat{\mytr(\bLambda_2^2)}
        =
        n^{-2}\sum_{i=r+1}^n \lambda_i^2(\bY^\top \bY-\widehat{\mytr(\bLambda_2)}\bI_n)
        $.
        Note that Weyl's inequality implies that for $i=r+1,\ldots,n$,
        \begin{equation*}
            \lambda_{i}(\bZ_2^\top \bLambda_2 \bZ_2 - \widehat{\mytr(\bLambda_2)}\bI_n)
            \leq
            \lambda_i(\bY^\top \bY-\widehat{\mytr(\bLambda_2)}\bI_n)
            \leq
            \lambda_{i-r}(\bZ_2^\top \bLambda_2 \bZ_2 - \widehat{\mytr(\bLambda_2)}\bI_n).
        \end{equation*}
Define
\begin{align*}
&\mathcal{C}_1=
\left\{i:
    1\leq i\leq n,\, \lambda_i\left(\bZ_2^\top \bLambda_2 \bZ_2-\widehat{\mytr(\bLambda_2)}\bI_n\right)> 0
\right\},
\\
&\mathcal{C}_2=
\left\{i:
    r+1\leq i\leq n, \,
    \lambda_{i-r}\left(\bZ_2^\top \bLambda_2 \bZ_2-\widehat{\mytr(\bLambda_2)}\bI_n\right)\leq 0
\right\}.
\end{align*}
It can be seen that $\mathcal{C}_1\cap \mathcal{C}_2 =\emptyset$ and $\text{Card}(\mathcal{C}_1\cup\mathcal{C}_2) \geq n - r$.
For $i\geq r+1$ and $i\in \mathcal{C}_1$,
    \begin{equation*}
        \lambda_i^2(\bZ_2^\top \bLambda_2 \bZ_2-\widehat{\mytr(\bLambda_2)}\bI_n) \leq \lambda_i^2(\bY^\top \bY-\widehat{\mytr(\bLambda_2)}\bI_n)\leq \lambda_{i-r}^2(\bZ_2^\top \bLambda_2 \bZ_2-\widehat{\mytr(\bLambda_2)}\bI_n);
    \end{equation*}
for $i\in \mathcal{C}_2$,
    \begin{equation*}
        \lambda_{i-r}^2(\bZ_2^\top \bLambda_2 \bZ_2-\widehat{\mytr(\bLambda_2)}\bI_n) \leq \lambda_i^2(\bY^\top \bY-\widehat{\mytr(\bLambda_2)}\bI_n)\leq \lambda_{i}^2(\bZ_2^\top \bLambda_2 \bZ_2-\widehat{\mytr(\bLambda_2)}\bI_n);
    \end{equation*}
    for $i\geq r+1$ and $i\notin \mathcal{C}_1\cup \mathcal{C}_2$,
    \begin{equation*}
        \lambda_i^2(\bY^\top \bY-\widehat{\mytr(\bLambda_2)}\bI_n)\leq
        \max
        \left(
            \lambda_{i-r}^2(\bZ_2^\top \bLambda_2 \bZ_2-\widehat{\mytr(\bLambda_2)}\bI_n) 
        ,
        \lambda_{i}^2(\bZ_2^\top \bLambda_2 \bZ_2-\widehat{\mytr(\bLambda_2)}\bI_n)
    \right).
    \end{equation*}
    Therefore,
    \begin{equation}\label{abcd0}
        \begin{split}
            &\left|
            \sum_{i=r+1}^n \lambda_i^2\left(\bY^\top \bY-\widehat{\mytr(\bLambda_2)}\bI_n\right)
            -\mytr(\bZ_2^\top \bLambda_2 \bZ_2-\widehat{\mytr(\bLambda_2)}\bI_n)^2
            \right|
            \\
            \leq&
            \left|
            \sum_{i>r,\, i\in \mathcal{C}_1} \lambda_i^2\left(\bY^\top \bY-\widehat{\mytr(\bLambda_2)}\bI_n\right)
            -\sum_{i\in\mathcal{C}_1}\lambda_i^2\left(\bZ_2^\top \bLambda_2 \bZ_2-\widehat{\mytr(\bLambda_2)}\bI_n\right)
            \right|
            \\
            &+
            \left|
            \sum_{i>r,\, i\in \mathcal{C}_2} \lambda_i^2\left(\bY^\top \bY-\widehat{\mytr(\bLambda_2)}\bI_n\right)
            -\sum_{i\notin \mathcal{C}_1}\lambda_i^2\left(\bZ_2^\top \bLambda_2 \bZ_2-\widehat{\mytr(\bLambda_2)}\bI_n\right)
            \right|
            \\
            &+
            \left|
            \sum_{i>r,\, i\notin \mathcal{C}_1\cup\mathcal{C}_2} \lambda_i^2\left(\bY^\top \bY-\widehat{\mytr(\bLambda_2)}\bI_n\right)
            \right|
            \\
            \leq & 3r \|\bZ_2^\top \bLambda_2 \bZ_2-\widehat{\mytr(\bLambda_2)}\bI_n\|^2\\
            \leq & 3r \left(\|\bZ_2^\top \bLambda_2 \bZ_2-\mytr(\bLambda_2)\bI_n\|+\left|\mytr(\bLambda_2)-\widehat{\mytr(\bLambda_2)}\right|\right)^2\\
            = & 
            O_P\left(rn \mytr(\bLambda_2^2) + r n^2 \blambda_{r+1}^2\right)
            .
        \end{split}
    \end{equation}
    where the last equality follows from~\eqref{conB2B} and the second statement of the proposition.

    Now we deal with $\mytr(\bZ_2^\top \bLambda_2 \bZ_2-\widehat{\mytr(\bLambda_2)}\bI_n)^2$.
    Let $Z_{2,i}$ be the $i$th column of $\bZ_2$, $i=1,\ldots, n$.
    Then
    \begin{equation*}
        \mytr(\bZ_2^\top \bLambda_2 \bZ_2-\widehat{\mytr(\bLambda_2)}\bI_n)^2
        =
        \sum_{i=1}^n (Z_{2,i}^\top \bLambda_2 Z_{2,i}-\widehat{\mytr(\bLambda_2)})^2
        +
        2\sum_{1\leq i<j\leq n} (Z_{2,i}^\top \bLambda_2 Z_{2,j})^2.
    \end{equation*}
    For the first term, we have 
    \begin{equation*}
        \sum_{i=1}^n (Z_{2,i}^\top \bLambda_2 Z_{2,i}-\widehat{\mytr(\bLambda_2)})^2
        \leq
        2\sum_{i=1}^n (Z_{2,i}^\top \bLambda_2 Z_{2,i}-\mytr(\bLambda_2))^2
        +2n(\widehat{\mytr(\bLambda_2)}-\mytr(\bLambda_2))^2.
    \end{equation*}
    Then it follows from the second statement of the proposition and the fact $
        \myE
        \sum_{i=1}^n (Z_{2,i}^\top \bLambda_2 Z_{2,i}-\mytr(\bLambda_2))^2
        =2n \mytr(\bLambda_2^2)
        $ that
        \begin{equation}\label{abcd1}
        \sum_{i=1}^n (Z_{2,i}^\top \bLambda_2 Z_{2,i}-\widehat{\mytr(\bLambda_2)})^2
        =O_P\left((n+r^2)\mytr(\bLambda_2^2)+r^2 n \blambda_{r+1}^2\right).
\end{equation}
    For the second term, it is straightforward to show that
    $\myE 2\sum_{1\leq i<j\leq n} (Z_{2,i}^\top \bLambda_2 Z_{2,j})^2=n(n-1)\mytr(\bLambda_2^2)$.
    Furthermore, \cite{chen2010tests}, Proposition A.2 implies that
    \begin{equation*}
        \begin{split}
        \myVar\left(
            2\sum_{1\leq i<j\leq n} (Z_{2,i}^\top \bLambda_2 Z_{2,j})^2
        \right)
        =& O\left(
            n^2 \mytr^2 (\bLambda_2^2) + n^3 \mytr(\bLambda_2^4)
        \right)
        \\
        =& O\left(
            n^2 \mytr^2 (\bLambda_2^2) + n \mytr(\bLambda_{2}^2) n^2 \blambda_{r+1}^2
        \right)
        \\
        =& O\left(
            n^2 \mytr^2 (\bLambda_2^2) + n^4 \blambda_{r+1}^4
        \right)
        .
        \end{split}
    \end{equation*}
    Thus,
    \begin{equation*}
            2\sum_{1\leq i<j\leq n} (Z_{2,i}^\top \bLambda_2 Z_{2,j})^2
            =
            n^2 \mytr(\bLambda_2^2)+O_P\left( n \mytr(\bLambda_2^2)+ n^{2}\blambda_{r+1}^2\right).
    \end{equation*}
    Combining the last display and~\eqref{abcd1} yields
    \begin{equation*}
        \mytr(\bZ_2^\top\bLambda_2 \bZ_2-\widehat{\mytr(\bLambda_2)}\bI_n)^2
        =
        n^2 \mytr(\bLambda_2^2)+O_P\left( (n+r^2) \mytr(\bLambda_2^2)+ (n+r^2)n\blambda_{r+1}^2\right)
        .
    \end{equation*}
    Combine the last display and~\eqref{abcd0}, we have
    \begin{equation*}
            \sum_{i=r+1}^n \lambda_i^2\left(\bY^\top \bY-\widehat{\mytr(\bLambda_2)}\bI_n\right)
            =
            O_P\left(rn \mytr(\bLambda_2^2) + r n^2 \blambda_{r+1}^2\right).
    \end{equation*}
    This completes the proof.

\end{proof}


\setcounter{proposition}{5}
\begin{proposition}\label{newEigenvectorProp}
    Suppose that $r=o(n)$ and $r\blambda_{r+1} /\mytr(\bLambda_2)\to 0$. Then
    \begin{equation*}
        \|\bP_{\bY,1} -\bP_{\bY,1}^* \|
        =O_P\left(\frac{\blambda_{r+1}+n^{-1}\mytr(\bLambda_2)}{\blambda_r +n^{-1}\mytr(\bLambda_2)}\right),
    \end{equation*}
    where
    \begin{equation*}
        \bP_{\bY,1}^*=
    \bU
    \begin{pmatrix}
       \bI_r \\
       \bQ
    \end{pmatrix}
    \left(\bI_r+ \bQ^\top \bQ \right)^{-1}
    \begin{pmatrix}
        \bI_r
          &
          \bQ^\top
        \end{pmatrix}
        \bU^\top.
    \end{equation*}
\end{proposition}
\begin{proof}
    The following intermediate matrix
    \begin{equation*}
        \begin{split}
    \hat{\bSigma}_0 =&
    n^{-1}\bU_1 \bLambda_1^{1/2} \bZ_1 \bZ_1^\top \bLambda_1^{1/2}\bU_1^\top
    +n^{-1}\bU_1 \bLambda_1^{1/2} \bZ_1 \bZ_2^\top \bLambda_2^{1/2}\bU_2^\top
    +n^{-1}\bU_2 \bLambda_2^{1/2} \bZ_2 \bZ_1^\top \bLambda_1^{1/2}\bU_1^\top
    \\
    &+n^{-1}\bU_2 \bLambda_2^{1/2} \bZ_2 \bV_{\bZ_1}\bV_{\bZ_1}^\top
    \bZ_2^\top \bLambda_2^{1/2}\bU_2^\top
        \end{split}
    \end{equation*}
    plays a key role in the proof.
    It can be seen that 
    \begin{equation*}
        \hat{\bSigma}_0=n^{-1}
    \bU
    \begin{pmatrix}
       \bI_r \\
       \bQ
    \end{pmatrix}
    \bLambda_1^{1/2}\bZ_1 \bZ_1^\top\bLambda_1^{1/2}
    \begin{pmatrix}
        \bI_r
          &
          \bQ^\top
        \end{pmatrix}
        \bU^\top.
    \end{equation*}
    Consequently, $\hat{\bSigma}_0$ is a positive semi-definite matrix with rank $r$, and $\bP_{\bY,1}^*$ is the projection matrix onto the rank $r$ principal subspace of $\hat{\bSigma}_0$.

    From~\cite{Cai2015Optimal}, Proposition 1, we have
    \begin{equation}\label{asd1}
        \|\bP_{\bY,1} -\bP_{\bY,1}^* \|
        \leq 
        \frac{2\|\hat{\bSigma}-\hat{\bSigma}_0\|}{\lambda_r(\hat{\bSigma}_0)}.
    \end{equation}
    We have the following upper bound for $\|\hat{\bSigma}-\hat{\bSigma}_0\|$.
    \begin{equation}\label{asd2}
        \begin{split}
            \|\hat{\bSigma}-\hat{\bSigma}_0\|
            =&
    n^{-1}\left\|\bU_2 \bLambda_2^{1/2} \bZ_2  
    \bZ_2^\top \bLambda_2^{1/2}\bU_2^\top
    -\bU_2 \bLambda_2^{1/2} \bZ_2 
    \bV_{\bZ_1}
    \bV_{\bZ_1}^\top
    \bZ_2^\top \bLambda_2^{1/2}\bU_2^\top
    \right\|
    \\
     =&
    n^{-1}\left\|
     \bLambda_2^{1/2} \bZ_2 
    (\bI_n-\bV_{\bZ_1}
    \bV_{\bZ_1}^\top)
    \bZ_2^\top \bLambda_2^{1/2}
    \right\|
    \\
    \leq &
    n^{-1}\left\|\bZ_2^\top \bLambda_2 \bZ_2\right\|
    \\
 \leq& 
     n^{-1}\left\| \bZ_2^\top \bLambda_2\bZ_2-\mytr(\bLambda_2)\bI_n\right\|
     +n^{-1}
     \mytr(\bLambda_2)
     \\
     =&O_P\left( 
\sqrt{\frac{\mytr\left(\bLambda_2^2\right)}{n}}+\blambda_{r+1}
     +
     n^{-1}\mytr(\bLambda_2)
 \right)
 \\
     =&O_P\left( 
\blambda_{r+1}
     +
     n^{-1}\mytr(\bLambda_2)
 \right)
 ,
    \end{split}
\end{equation}
where
the second last equality follows from~\eqref{conB2B} and the last equality follows from
\begin{equation*}
    \sqrt{\frac{\mytr\left(\bLambda_2^2\right)}{n}}
    \leq
    \sqrt{\frac{\blambda_{r+1}\mytr\left(\bLambda_2\right)}{n}}
    \leq
    \frac{1}{2}\left(\blambda_{r+1}+n^{-1}\mytr\left(\bLambda_2\right)\right).
\end{equation*}
Now we deal with $\lambda_r(\hat{\bSigma}_0)$.
We have
\begin{equation*}
    \begin{split}
     \lambda_r(\hat{\bSigma}_0)
     =&\lambda_r\left(
n^{-1}
  (\bZ_1\bZ_1^\top)^{1/2}\bLambda_1^{1/2}(\bI_r +\bQ^\top \bQ)\bLambda_1^{1/2} (\bZ_1\bZ_1^\top)^{1/2}
     \right)
     \\
     =&
     \lambda_r\left(
        n^{-1} (\bZ_1\bZ_1^\top)^{1/2}
         \bLambda_1 
         (\bZ_1\bZ_1^\top)^{1/2}
         +
         n^{-1} \bV_{\bZ_1}^\top \bZ_2^\top \bLambda_2 \bZ_2 \bV_{\bZ_1} 
    \right).
    \end{split}
\end{equation*}
It can be seen that $\bZ_2 \bV_{\bZ_1}$ is a $(p-r)\times r$ random matrix with iid $\mathcal{N}(0,1)$ entries.
Then Lemma~\ref{lemma:con} implies that
\begin{equation}\label{projCon}
        \begin{split}
        \left\|n^{-1}  \bV_{\bZ_1}^\top \bZ_2^\top \bLambda_2 \bZ_2 \bV_{\bZ_1} 
        -n^{-1} \mytr(\bLambda_2) \bI_r
        \right\|
        =&
        O_P\left(
            n^{-1}\sqrt{r\mytr\left(\bLambda_2^2\right)}
            +rn^{-1}\blambda_{r+1}
        \right)
        \\
        =&
        O_P\left(
            n^{-1}\sqrt{r\blambda_{r+1}\mytr\left(\bLambda_2\right)}
            +rn^{-1}\blambda_{r+1}
        \right)
        \\
        =&o_P\left(n^{-1}\mytr(\bLambda_2)\right)
        ,
        \end{split}
    \end{equation}
    where the last equality follows from the condition $r\blambda_{r+1} /\mytr(\bLambda_2)\to 0$.
    Then it follows from Weyl's inequality that 
    \begin{equation*}
        \begin{split}
        &\left| 
        \lambda_r (\hat{\bSigma}_0)-
     \lambda_r\left(
        n^{-1} (\bZ_1\bZ_1^\top)^{1/2}
         \bLambda_1 
         (\bZ_1\bZ_1^\top)^{1/2}
         +
         n^{-1} \mytr(\bLambda_2)\bI_r 
    \right)
    \right|
\\
\leq &\left\|n^{-1} \bV_{\bZ_1}^\top \bZ_2^\top \bLambda_2 \bZ_2 \bV_{\bZ_1} 
        -n^{-1} \mytr(\bLambda_2) \bI_r
        \right\|
        \\
        =&o_P\left(n^{-1}\mytr(\bLambda_2)\right).
        \end{split}
    \end{equation*}
    On the other hand,~\eqref{eigenBoundForA} and~\eqref{conB2B1} imply that
    \begin{equation*}
        \begin{split}
        &
     \lambda_r\left(
        n^{-1} (\bZ_1\bZ_1^\top)^{1/2}
         \bLambda_1 
         (\bZ_1\bZ_1^\top)^{1/2}
         +
         n^{-1} \mytr(\bLambda_2)\bI_r 
    \right)
\\
        =&
     \lambda_r\left(
        n^{-1} \bZ_1^\top
         \bLambda_1 
         \bZ_1
    \right)
         +
         n^{-1} \mytr(\bLambda_2)
        \\
        =&
        \blambda_r +o_P(\blambda_r)
         +
         n^{-1} \mytr(\bLambda_2).
        \end{split}
    \end{equation*}
    Hence we have 
    \begin{equation}\label{asd3}
    \lambda_r(\hat{\bSigma}_0)=(1+o_P(1))(\blambda_r+n^{-1}\mytr(\bLambda_2)).
    \end{equation}
    Then the conclusion follows from~\eqref{asd1},~\eqref{asd2} and~\eqref{asd3}.
\end{proof}

\begin{proof}[\textbf{Proof of Proposition~\ref{newEigenvectorPropCor}}]
    Note that
    \begin{equation*}
        \begin{split}
        &
        \left\|
\bP_{\bY,1}
         - 
\bP_{\bY,1}^{\dagger}
        \right\|
        \leq
        \left\|
\bP_{\bY,1}
-
        \bP_{\bY,1}^*
        \right\|
        +
        \left\|
        \bP_{\bY,1}^* 
            -
\bP_{\bY,1}^{\dagger}
            \right\|.
        \end{split}
    \end{equation*}
    Under the condition $\mytr(\bLambda_2)/(n\blambda_r)\to 0$, Proposition~\ref{newEigenvectorProp} implies that
    \begin{equation*}
        \left\|
\bP_{\bY,1}-
        \bP_{\bY,1}^*
        \right\|
    =O_P\left(\frac{\blambda_{r+1}}{\blambda_r}+\frac{\mytr(\bLambda_2)}{n\blambda_r}\right).
    \end{equation*}
    So we only need to deal with $
        \|
        \bP_{\bY,1}^* 
            -
\bP_{\bY,1}^{\dagger}
            \|
    $.
    We have
    \begin{equation*}
        \begin{split}
        &\left\|
        \bP_{\bY,1}^* 
            -
\bP_{\bY,1}^{\dagger}
        \right\|
        \\
        \leq&
        \Big\|
        \bP_{\bY,1}^* 
        -
        \bU
        \begin{pmatrix}
           \bI_r \\
           \bQ
        \end{pmatrix}
        \begin{pmatrix}
            \bI_r
              &
              \bQ^\top
            \end{pmatrix}
            \bU^\top
        \Big\|
        +
        \Big\|
        \bU
        \begin{pmatrix}
           \bI_r \\
           \bQ
        \end{pmatrix}
        \begin{pmatrix}
            \bI_r
              &
              \bQ^\top
            \end{pmatrix}
            \bU^\top
            -
\bP_{\bY,1}^{\dagger}
        \Big\|
        \\
        =&
        \Big\|
        \begin{pmatrix}
           \bI_r \\
           \bQ
        \end{pmatrix}
        \left(
            \left(\bI_r+\bQ^{\top}\bQ \right)^{-1}
            -\bI_r
        \right)
        \begin{pmatrix}
            \bI_r
              &
              \bQ^\top
            \end{pmatrix}
        \Big\|
        +\left\| \bU_2 \bQ \bQ^\top \bU_2^\top \right\|
        \\
        =&
        \Big\|
        \left(
            \left(\bI_r+\bQ^{\top}\bQ \right)^{-1}
            -\bI_r
        \right)
        \left(\bI_r + \bQ^\top \bQ \right)
        \Big\|
        +\left\| \bU_2 \bQ \bQ^\top \bU_2^\top \right\|
        \\
        =&2 \left\| \bQ^\top \bQ\right\|
        .
        \end{split}
    \end{equation*}
    Note that
    \begin{equation}\label{UpperBoundQ}
        \begin{split}
        \|\bQ^\top \bQ \|
        =& \left\|
        \bLambda_1^{-1/2} (\bZ_1 \bZ_1^\top)^{-1/2} \bV_{\bZ_1}^\top \bZ_2^\top \bLambda_2 \bZ_2 \bV_{\bZ_1} (\bZ_1 \bZ_1^\top)^{-1/2} \bLambda_1^{-1/2}
        \right\|
        \\
        \leq &
        \blambda_r^{-1}\left\|(\bZ_1\bZ_1^\top)^{-1}\right\| \left\|\bV_{\bZ_1}^\top \bZ_2^\top \bLambda_2 \bZ_2 \bV_{\bZ_1}\right\|
        \\
= & O_P\left(\frac{\mytr(\bLambda_2)}{n\blambda_r}\right),
        \end{split}
    \end{equation}
    where the second last equality follows from the fact $\|(\bZ_1 \bZ_1^\top)^{-1}\|=\lambda_r(\bZ_1\bZ_1^\top)^{-1}$, \eqref{conB2B1},~\eqref{projCon} and Weyl's inequality.
    Therefore, we have 
    \begin{equation*}
        \left\|
        \bP_{\bY,1}^* 
            -
\bP_{\bY,1}^{\dagger}
            \right\|= O_P\left(\frac{\mytr(\bLambda_2)}{n\blambda_r}\right)
            .
    \end{equation*}
    This completes the proof.

\end{proof}


\begin{proposition}
    \label{eigenvectorprop2}
    Suppose that $r=o(n)$ and $n\blambda_{r+1} /\mytr(\bLambda_2)\to 0$. Then
    \begin{equation*}
            \left\|
            \bP_{\bY,2}
            -
            \bP_{\bY,2}^*
            \right\|
    = 
    O_P\left(
        \min\left(
        \sqrt{\frac{\mytr(\bLambda_2) \blambda_1}{n\blambda_r^2}}
    ,1\right)
    \right)
    .
    \end{equation*}
where
$
            \bP_{\bY,2}^*=
            \bU_2 \bLambda_2^{1/2}\bZ_{2} \tilde{\bV}_{\bZ_1}
            \left(\tilde{\bV}_{\bZ_1}^\top \bZ_2^\top \bLambda_2 \bZ_2 \tilde{\bV}_{\bZ_1}\right)^{-1}
            \tilde{\bV}_{\bZ_1}^\top \bZ_2^\top \bLambda_2^{1/2} \bU_2^\top
            $.
\end{proposition}
%\begin{remark}
    %The condition $n\blambda_{r+1} /\mytr(\bLambda_2)\to 0$ implies $n/\myrank(\bLambda_2) \to 0$.
    %Consequently, the matrix $\tilde{\bV}_{\bZ_1}^\top \bZ_2^\top \bLambda_2 \bZ_2 \tilde{\bV}_{\bZ_1}$ is invertible with probability $1$ for large $n$.
%\end{remark}
\begin{proof}
    We only need to prove that for any subsequence of $\{n\}$, there is a further subsequence along which the conclusion holds.
    Thus, without loss of generality, we assume $\mytr(\bLambda_2)\blambda_1 /{(n \blambda_r^2)}\to c\in [0,+\infty]$.
    Since $
    \bP_{\bY,2}
    $ and 
    $
    \bP_{\bY,2}^*
            $
            are both projection matrices, we have
            $
            \left\|
    \bP_{\bY,2}
    -
            \bP_{\bY,2}^*
            \right\|
            \leq 2
            $
    .
    Therefore, the conclusion holds if $c>0$.
    In the rest of the proof, we assume $c=0$, that is $\mytr(\bLambda_2)\blambda_1 /{(n \blambda_r^2)}\to 0$.


    Note that $\bU_{\bY,2}$ is in fact the leading $n-r$ eigenvectors of $(\bI_p -\bP_{\bY,1})\hat{\bSigma}(\bI_p -\bP_{\bY,1})$.
    Under the condition $n\blambda_{r+1}/\mytr(\bLambda_2)\to 0$,
    Proposition~\ref{newEigenvectorPropCor} implies that 
    \begin{equation*}
        \left\|
        \bP_{\bY,1}
        - 
\bP^\dagger_{\bY,1}
        \right\|
    =O_P\left(\frac{\mytr(\bLambda_2)}{n\blambda_r}\right).
    \end{equation*}
    It can be seen that
    \begin{equation*}
        \begin{split}
             &
             \left\|(\bI_p -\bP_{\bY,1})\hat{\bSigma}(\bI_p -\bP_{\bY,1})
             -
             (\bI_p -\bP^\dagger_{\bY,1})\hat{\bSigma}(\bI_p-\bP^\dagger_{\bY,1})
             \right\|
             \\
             \leq&
             \left\|
             (\bP^\dagger_{\bY,1}-\bP_{\bY,1})\hat{\bSigma}(\bP^\dagger_{\bY,1}-\bP_{\bY,1})
             \right\|
             +
             2\left\|
             (\bP^\dagger_{\bY,1}-\bP_{\bY,1})\hat{\bSigma}(\bI_p-\bP^\dagger_{\bY,1})
             \right\|
             .
        \end{split}
    \end{equation*}
    Under the condition $n\blambda_{r+1}/\mytr(\bLambda_2)\to 0$, Proposition~\ref{eigenvalueProp} implies that
    \begin{equation*}
        \|\hat{\bSigma}\|
        =\blambda_1\left(
            1+\frac{\mytr(\bLambda_2)}{n\blambda_1}+O_P\left(\sqrt{\frac{r}{n}}+\sqrt{\frac{\blambda_{r+1}}{\blambda_1}\frac{\mytr(\bLambda_2)}{n\blambda_1}}+\frac{\blambda_{r+1}}{\blambda_1}\right)
        \right)
        =\blambda_1(1+o_P(1)).
    \end{equation*}
     Then
     \begin{equation}\label{aiBound1}
        \begin{split}
             &\left\|
             (\bP^\dagger_{\bY,1}-\bP_{\bY,1})\hat{\bSigma}(\bP^\dagger_{\bY,1}-\bP_{\bY,1})
             \right\|
             \leq
             \|\hat{\bSigma}\|
             \left\|
             \bP^\dagger_{\bY,1}-\bP_{\bY,1}
             \right\|^2
                 =
            O_P
                \left(
                    \frac{\mytr^2(\bLambda_2)\blambda_1}{n^2 \blambda_r^2}
                \right).
        \end{split}
    \end{equation}
    %where the last equality follows from Proposition~\ref{eigenvectorProp}.
    On the other hand, we have
    \begin{equation*}
        \begin{split}
             &\left\|(\bP^\dagger_{\bY,1}-\bP_{\bY,1})\hat{\bSigma}(\bI_p-\bP^\dagger_{\bY,1})\right\|
             \\
             \leq &
             \left\|\bP^\dagger_{\bY,1}-\bP_{\bY,1}\right\|
             \left\|n^{-1}\bU \bLambda^{1/2} \bZ\right\|
             \left\|\bZ^\top \bLambda^{1/2} \bU^\top (\bI_p-\bP^\dagger_{\bY,1})\right\|
             \\
             = &
             n^{-1/2}\left\|\bP^\dagger_{\bY,1}-\bP_{\bY,1}\right\|
             \left\|\hat{\bSigma}\right\|^{1/2}
             \left\|\bZ^\top \bLambda^{1/2} \bU^\top (\bI_p-\bP^\dagger_{\bY,1})\right\|
             \\
             =&
            O_P\left(
                \frac{\mytr(\bLambda_2)\blambda_1^{1/2}}{n^{3/2}\blambda_r}
                \right)
             \left\| \bZ^\top \bLambda^{1/2} \bU^\top (\bI_p-\bP^\dagger_{\bY,1})\right\|
                 .
        \end{split}
    \end{equation*}
    It is straightforward to show that
    \begin{equation}\label{straightforwardHaha}
        \bZ^\top \bLambda^{1/2}\bU^\top (\bI_p-\bP^\dagger_{\bY,1})  
        =\tilde\bV_{\bZ_1} \tilde\bV_{\bZ_1}^\top\bZ_2^\top \bLambda_2^{1/2}\bU_2^\top   
        - \bZ_2^\top \bLambda_2 \bZ_2  \bZ_1^\top (\bZ_1 \bZ_1^\top)^{-1}\bLambda_1^{-1/2} \bU_1^\top.
    \end{equation}
    Then
    \begin{equation*}
        \left\|
        \bZ^\top \bLambda^{1/2}\bU^\top (\bI_p-\bP^\dagger_{\bY,1})  
        \right\|
        \leq 
         \left\|\bZ_2^\top \bLambda_2 \bZ_2\right\|^{1/2}
         +
         \blambda_r^{-1/2}  \left\|\bZ_2^\top \bLambda_2 \bZ_2\right\|  \left\|(\bZ_1\bZ_1^\top)^{-1}\right\|^{1/2}
         .
    \end{equation*}
    It follows from~\eqref{conB2B} and the condition $n\blambda_{r+1}/\mytr(\bLambda_2)\to 0$ that
    \begin{equation}\label{Z2exactL}
    \|\bZ_2^\top \bLambda_2 \bZ_2\| =\left(1+o_P(1)\right)\mytr (\bLambda_2).
    \end{equation}
        Consequently,
    \begin{equation*}
        \begin{split}
        \left\|
        \bZ^\top \bLambda^{1/2}\bU^\top (\bI_p-\bP^\dagger_{\bY,1})  
        \right\|
         = 
         O_P\left(
             \mytr^{1/2}(\bLambda_2)
         \right)
         +O_P\left(
             \frac{\mytr(\bLambda_2)}{\sqrt{n\blambda_r}}
         \right)
         = 
         O_P\left(
             \mytr^{1/2}(\bLambda_2)
         \right).
        \end{split}
    \end{equation*}
    Thus,
    \begin{equation}\label{aiBound2}
    \left\|(\bP^\dagger_{\bY,1}-\bP_{\bY,1})\hat{\bSigma}(\bI_p-\bP^\dagger_{\bY,1})\right\|
             =O_P\left(
                 \frac{\mytr^{3/2}(\bLambda_2)\blambda_1^{1/2}}{n^{3/2}\blambda_r}
                \right).
    \end{equation}
    Combine~\eqref{aiBound1} and~\eqref{aiBound2}, we obtain
    \begin{equation*}
        \begin{split}
             &\left\|(\bI_p -\bP_{\bY,1})\hat{\bSigma}(\bI_p -\bP_{\bY,1})
             -
             (\bI_p-\bP^\dagger_{\bY,1})\hat{\bSigma}(\bI_p-\bP^\dagger_{\bY,1})\right\|
             \\
             =&
             O_P\left(
                    \frac{\mytr^2(\bLambda_2)\blambda_1}{n^2 \blambda_r^2}
                 +
                 \frac{\mytr^{3/2}(\bLambda_2)\blambda_1^{1/2}}{n^{3/2}\blambda_r}
                \right).
        \end{split}
    \end{equation*}

    Now we deal with $(\bI_p-\bP^\dagger_{\bY,1})\hat{\bSigma}(\bI_p-\bP^\dagger_{\bY,1})$.
    In view of~\eqref{straightforwardHaha}, we have
    \begin{equation*}
        \begin{split}
             &(\bI_p-\bP^\dagger_{\bY,1})\hat{\bSigma}(\bI_p-\bP^\dagger_{\bY,1})
             \\
             =&
             n^{-1}\bU_2 \bLambda_2^{1/2} \bZ_2 \tilde\bV_{\bZ_1} \tilde\bV_{\bZ_1}^\top \bZ_2^\top \bLambda_2^{1/2} \bU_2^\top
             -
             n^{-1} \bU_2 \bLambda_2^{1/2} \bZ_2 \tilde\bV_{\bZ_1} \tilde\bV_{\bZ_1}^\top 
             \bZ_2^\top \bLambda_2^{1/2} \bQ \bU_1^\top
             \\
             &-
             n^{-1} \bU_1 \bQ^\top \bLambda_2^{1/2} \bZ_2  \tilde\bV_{\bZ_1} \tilde\bV_{\bZ_1}^\top \bZ_2^\top \bLambda_2^{1/2} \bU_2^\top
             +
             n^{-1}
             \bU_1 \bQ^\top \bLambda_2^{1/2} \bZ_2 \bZ_2^\top \bLambda_2^{1/2} \bQ \bU_1^\top
.
        \end{split}
    \end{equation*}
    Then
    \begin{equation*}
        \begin{split}
             &\left\|
             (\bI_p-\bP^\dagger_{\bY,1})\hat{\bSigma}(\bI_p-\bP^\dagger_{\bY,1})
             -
             n^{-1}\bU_2 \bLambda_2^{1/2} \bZ_2 \tilde \bV_{\bZ_1}\tilde \bV_{\bZ_1}^\top \bZ_2^\top \bLambda_2^{1/2} \bU_2^\top
             \right\|
             \\
             \leq&
             n^{-1} 
             \left\|
             \bLambda_2^{1/2} \bZ_2 \tilde \bV_{\bZ_1} \tilde \bV_{\bZ_1}^\top \bZ_2^\top \bLambda_2^{1/2}\bQ
              \right\|
             +
             n^{-1}
\left\|
             \bQ^\top \bLambda_2^{1/2} \bZ_2 \bZ_2^\top \bLambda_2^{1/2} \bQ 
\right\|
\\
\leq&
n^{-1} \|\bZ_2^\top \bLambda_2 \bZ_2\| \|\bQ^\top \bQ\|^{1/2}
+n^{-1}\|\bZ_2^\top \bLambda_2 \bZ_2\| \|\bQ^\top \bQ\|
\\
=&O_P\left(\frac{\mytr^{3/2}(\bLambda_2)}{n^{3/2}\blambda_r^{1/2}}\right)
,
        \end{split}
    \end{equation*}
    where the last equality follows from~\eqref{UpperBoundQ} and~\eqref{Z2exactL}.

    Combine the above bounds, we obtain
    \begin{equation}\label{haoqilai1}
        \begin{split}
             &\left\|(\bI_p -\bP_{\bY,1})\hat{\bSigma}(\bI_p -\bP_{\bY,1})
             -
         n^{-1}\bU_2 \bLambda_2^{1/2} \bZ_2 \tilde{\bV}_{\bZ_1}\tilde{\bV}_{\bZ_1}^\top  \bZ_2^\top \bLambda_2^{1/2} \bU_2^\top
             \right\|
             \\
             =&
             O_P\left(
                    \frac{\mytr^2(\bLambda_2)\blambda_1}{n^2 \blambda_r^2}
                 +
                 \frac{\mytr^{3/2}(\bLambda_2)\blambda_1^{1/2}}{n^{3/2}\blambda_r}
                \right).
        \end{split}
    \end{equation}
    The matrix $n^{-1}\bU_2 \bLambda_2^{1/2} \bZ_2 \tilde{\bV}_{\bZ_1}\tilde{\bV}_{\bZ_1}^\top  \bZ_2^\top \bLambda_2^{1/2} \bU_2^\top$ shares the same non-zero eigenvalues as $n^{-1} \tilde{\bV}_{\bZ_1}^\top\bZ_2^\top\bLambda_2 \bZ_2 \tilde{\bV}_{\bZ_1}$.
    Note that $\bZ_{2}\tilde{\bV}_{\bZ_1}$ is a $p\times (n-r)$ random matrix with iid $\mathcal{N}(0,1)$ entries.
    Then it follows from Lemma~\ref{lemma:con} and the condition $n\blambda_{r+1}/\mytr(\bLambda_2)\to 0$ that
    \begin{equation}\label{choc8}
        \begin{split}
        \left\|
        n^{-1} \tilde{\bV}_{\bZ_1}^\top\bZ_2^\top\bLambda_2 \bZ_2 \tilde{\bV}_{\bZ_1}-n^{-1}\mytr(\bLambda_2)\bI_{n-r}
        \right\|
        =&O_P\left(n^{-1/2}\sqrt{\mytr(\bLambda_2^2)}+\blambda_{r+1}\right)
        \\
        = &
        O_P\left(n^{-1/2}\sqrt{\blambda_{r+1}\mytr(\bLambda_2)}+\blambda_{r+1}\right)
        \\
        =& o_P\left(n^{-1}\mytr(\bLambda_2)\right).
        \end{split}
    \end{equation}
    This bound, combined with Weyl's inequality, leads to
    \begin{equation}\label{haoqilai2}
        %\lambda_{n-r}\left(
            %n^{-1}\bU_2 \bLambda_2^{1/2} \bZ_2 \tilde{\bV}_{\bZ_1}\tilde{\bV}_{\bZ_1}^\top  \bZ_2^\top \bLambda_2^{1/2} \bU_2^\top
        %\right)
        %=
        \lambda_{n-r}\left(
            n^{-1} \tilde{\bV}_{\bZ_1}^\top\bZ_2^\top\bLambda_2 \bZ_2 \tilde{\bV}_{\bZ_1}   
        \right)
        =(1+o_P(1))n^{-1}\mytr(\bLambda_1).
    \end{equation}
    %As a result, the matrix $n^{-1}\bU_2 \bLambda_2^{1/2} \bZ_2 \tilde{\bV}_{\bZ_1}\tilde{\bV}_{\bZ_1}^\top  \bZ_2^\top \bLambda_2^{1/2} \bU_2^\top$ is of rank $n-r$.
    It can be seen that the matrix $
    \bP_{\bY,2}^*
            $ is the projection matrix onto the rank $n-r$ principal subspace of $n^{-1}\bU_2 \bLambda_2^{1/2} \bZ_2 \tilde{\bV}_{\bZ_1}\tilde{\bV}_{\bZ_1}^\top  \bZ_2^\top \bLambda_2^{1/2} \bU_2^\top$.
            Therefore,~\cite{Cai2015Optimal}, Proposition 1 implies that
    \begin{equation*}
        \begin{split}
            &\left\|\bP_{\bY,2}-
            \bP_{\bY,2}^*
            \right\|
            \\
             \leq&
             \frac{
                 2\left\|(\bI_p -\bP_{\bY,1})\hat{\bSigma}(\bI_p -\bP_{\bY,1})
             -
         n^{-1}\bU_2 \bLambda_2^{1/2} \bZ_2 \tilde{\bV}_{\bZ_1}\tilde{\bV}_{\bZ_1}^\top  \bZ_2^\top \bLambda_2^{1/2} \bU_2^\top
             \right\|
         }{
        \lambda_{n-r}\left(
            n^{-1}\bU_2 \bLambda_2^{1/2} \bZ_2 \tilde{\bV}_{\bZ_1}\tilde{\bV}_{\bZ_1}^\top  \bZ_2^\top \bLambda_2^{1/2} \bU_2^\top
        \right)
    }
    \\
    = &
    O_P\left(
        \frac{\mytr(\bLambda_2) \blambda_1}{n\blambda_r^2}
        +
        \sqrt{\frac{\mytr(\bLambda_2) \blambda_1}{n\blambda_r^2}}
    \right)
    \\
    = &
    O_P\left(
        \sqrt{\frac{\mytr(\bLambda_2) \blambda_1}{n\blambda_r^2}}
    \right)
    ,
        \end{split}
    \end{equation*}
    where the second last equality follows from~\eqref{haoqilai1} and~\eqref{haoqilai2}.
    This completes the proof.
\end{proof}


\begin{proof}[\textbf{Proof of Proposition \ref{eigenvectorprop3}}]
    By some algebra,
    it can be seen that
    \begin{equation*}
        \begin{split}
            \Big\|
            \bP_{\bY,2}^{*}
            -
            \bP_{\bY,2}^{\dagger}
            \Big\|
            =&
            \left(\mytr(\bLambda_2)\right)^{-1}
            \left\|
            \tilde{\bV}_{\bZ_1}^\top \bZ_2^\top \bLambda_2 \bZ_2 \tilde{\bV}_{\bZ_1}
            -
            \mytr(\bLambda_2)
            \bI_{n-r}
            \right\|
            \\
            =&
            O_P\left(\frac{\sqrt{n\mytr(\bLambda_2^2)}}{\mytr(\bLambda_2)}+\frac{n\blambda_{r+1}}{\mytr(\bLambda_2)}\right)
            \\
            =&
            O_P\left(\sqrt{\frac{n\blambda_{r+1}}{\mytr(\bLambda_2)}}\right)
            ,
        \end{split}
    \end{equation*}
    where the second last equality follows from \eqref{choc8} and the last equality follows from the fact ${\sqrt{n\mytr(\bLambda_2^2)}}/{\mytr(\bLambda_2)}\leq{\sqrt{n\blambda_{r+1}/\mytr(\bLambda_2)}}$ and the condition ${\sqrt{n\blambda_{r+1}/\mytr(\bLambda_2)}}\to 0$.
    Then the conclusion follows from the last display and Proposition~\ref{eigenvectorprop2}.
     
\end{proof}




%\section{Proofs of Theorems \ref{fenTheorem1} and \ref{thm1}}
\section{Proofs of Theorems 1 and 2}
\setcounter{equation}{0}
It can be seen that $\bX\bJ\bC$ is independent of $\bY$.
We write
$
\bX\bJ\bC = \bTheta \bC + \bU\bLambda^{1/2} \bZ^{\dagger}
$, 
where $\bZ^{\dagger}$ is a $p\times (k-1)$ matrix with iid $\mathcal{N}(0,1)$ entries and is independent of $\bZ$.
Then 
\begin{equation}\label{eq:maindec}
\begin{aligned}
\bC^\top\bJ^\top \bX^\top(\bI_p-\bP_{\bY}) \bX\bJ\bC
=&
\bZ^{\dagger \top} \bLambda^{1/2}\bU^\top (\bI_p-\bP_{\bY})\bU\bLambda^{1/2}\bZ^{\dagger}+
 \bC^\top \bTheta^\top (\bI_p -\bP_{\bY})\bTheta \bC\\
 &+ \bC^\top \bTheta^\top (\bI_p -\bP_{\bY})\bU\bLambda^{1/2}\bZ^{\dagger}+
 \bZ^{\dagger \top} \bLambda^{1/2}\bU^\top (\bI_p-\bP_{\bY})\bTheta \bC.
\end{aligned}
\end{equation}
    It can be seen that the first term of~\eqref{eq:maindec} can be written as
\begin{equation*}
    \bZ^{\dagger \top} \bLambda^{1/2}\bU^\top (\bI_p-\bP_{\bY})\bU\bLambda^{1/2}\bZ^{\dagger}=
\sum_{i=1}^p \lambda_i ( (\bI_p-\bP_{\bY})\bSigma (\bI_p-\bP_{\bY}))\eta_i \eta_i^\top,
\end{equation*}
where $\eta_1,\ldots, \eta_p$ are independent $\mathcal{N}_{k-1}(\mathbf{0}_{k-1},\bI_{k-1})$ random vectors and are independent of $\bP_{\bY}$.

\begin{lemma}
    \label{fenLemma1}
    Suppose that $n\blambda_1/\mytr(\bSigma)\to 0$.
    Then
    \begin{equation*}
        \begin{aligned}
        \mytr \left( (\bI_p-\bP_{\bY})\bSigma (\bI_p-\bP_{\bY})\right)&=
        \mytr(\bSigma)-\frac{n\mytr(\bSigma^2)}{\mytr(\bSigma)}
        +O_P\left(n(\blambda_1-\blambda_p)\sqrt{\frac{n\blambda_1}{\mytr(\bSigma)}}\right)
        ,
        \\
        \mytr \left( (\bI_p-\bP_{\bY})\bSigma (\bI_p-\bP_{\bY})\right)^2&=
        \mytr(\bSigma^2)-\frac{n\mytr^2 (\bSigma^2)}{\mytr^2(\bSigma)}+O_P(n\blambda_1(\blambda_1-\blambda_p)).
        \end{aligned}
    \end{equation*}
\end{lemma}
\begin{proof}
    First we approximate $\bP_{\bY}$ by a simple expression.
    We have
        \begin{equation*}
            \begin{split}
        \left\|
        \bP_{\bY}
        -(\mytr(\bSigma))^{-1} \bY \bY^\top
        \right\|
        =  
        &
        \left\|
        \bY (\bY^\top \bY)^{-1} \bY^\top
    -(\mytr(\bSigma))^{-1} \bY \bY^\top
        \right\|
        \\
        =&
        (\mytr(\bSigma))^{-1}
        \left\|
        \bY^\top \bY -\mytr(\bSigma)\bI_n
        \right\|.
            \end{split}
        \end{equation*}
        Then from Lemma~\ref{lemma:con}, we have
        \begin{equation}\label{fenEq1}
            \begin{split}
        \left\|
        \bP_{\bY}
        -(\mytr(\bSigma))^{-1} \bY \bY^\top
        \right\|
        =&
        (\mytr(\bSigma))^{-1}
        \left\|
        \bZ^\top \bSigma \bZ -\mytr(\bSigma)\bI_n
        \right\|
        \\
        =&O_P\left(
            \frac{\sqrt{n\mytr(\bSigma^2)}} {\mytr(\bSigma)}
            +\frac{n\blambda_1}{\mytr(\bSigma)}
        \right)
        \\
        =&O_P\left(
            \frac{\sqrt{n\blambda_1\mytr(\bSigma)}} {\mytr(\bSigma)}
            +\frac{n\blambda_1}{\mytr(\bSigma)}
        \right)
        \\
        =&O_P\left(
            \sqrt{\frac{n\blambda_1} {\mytr(\bSigma)}}
        \right).
        \end{split}
        \end{equation}

        Now we deal with $
        \mytr \left( (\bI_p-\bP_{\bY})\bSigma (\bI_p-\bP_{\bY})\right)
        $.
        It can be seen that
        \begin{equation}\label{fenEq2}
        \begin{split}
        \mytr \left( (\bI_p-\bP_{\bY})\bSigma (\bI_p-\bP_{\bY})\right)
        =&
        \mytr \left(\bSigma \right)-
        \mytr \left(\bSigma\bP_{\bY}\right)
        \\
        =&
        \mytr \left(\bSigma \right)-
        \mytr \left(\left(\bSigma - \frac{\mytr(\bSigma^2)}{\mytr(\bSigma)} \bI_p \right)\bP_{\bY}\right)
        -\frac{n\mytr(\bSigma^2)}{\mytr(\bSigma)}
        .
        \end{split}
    \end{equation}
    For the second term, we have
    \begin{equation*}
        \begin{split}
        &\left|
        \mytr \left(\left(\bSigma - \frac{\mytr(\bSigma^2)}{\mytr(\bSigma)} \bI_p \right)\bP_{\bY}\right)
        -
        \left(\mytr(\bSigma)\right)^{-1}\mytr \left(\left(\bSigma - \frac{\mytr(\bSigma^2)}{\mytr(\bSigma)} \bI_p \right)\bY \bY^\top\right)
        \right|
        \\
        =&\left|\mytr \left(\left(\bSigma - \frac{\mytr(\bSigma^2)}{\mytr(\bSigma)} \bI_p \right)\left(\bP_{\bY}- \left(\mytr(\bSigma)\right)^{-1}\bY\bY^\top \right)\right)
        \right|
        \\
        \leq&
2n 
\left\|
\bSigma - \frac{\mytr(\bSigma^2)}{\mytr(\bSigma)} \bI_p
\right\|
\left\|
\bP_{\bY}- \left(\mytr(\bSigma)\right)^{-1}\bY\bY^\top 
\right\|
        \\
        =&
        O_P\left(
            n(\blambda_1-\blambda_p)\sqrt{\frac{n\blambda_1}{\mytr(\bSigma)}}
        \right)
,
        \end{split}
    \end{equation*}
    where the last inequality follows from von Neumann's trace theorem and the fact $\myrank\left( \bP_{\bY}-\left(\mytr(\bSigma)\right)^{-1}\bY\bY^\top \right)\leq 2n$, and the last equality follows from \eqref{fenEq1}
    and the fact $\mytr(\bSigma^2)/\mytr(\bSigma)\in [\blambda_p, \blambda_1]$.
    On the other hand, it is straightforward to show that
    \begin{equation*}
        \myE \left(
        \left(\mytr(\bSigma)\right)^{-1}\mytr \left(\left(\bSigma - \frac{\mytr(\bSigma^2)}{\mytr(\bSigma)} \bI_p \right)\bY \bY^\top\right)
    \right)=0,
    \end{equation*}
and
    \begin{equation*}
        \begin{split}
        &\myVar \left(
        \left(\mytr(\bSigma)\right)^{-1}\mytr \left(\left(\bSigma - \frac{\mytr(\bSigma^2)}{\mytr(\bSigma)} \bI_p \right)\bY \bY^\top\right)
    \right)\\
    =
    &
    \frac{2n}{\mytr^2(\bSigma)}
    \mytr
    \left(
\bSigma^2 - \frac{\mytr(\bSigma^2)}{\mytr(\bSigma)} \bSigma
    \right)^2
    \\
    =&
    \frac{2n}{\mytr^2(\bSigma)}
    \sum_{i=1}^p \blambda_i^2\left(\blambda_i-\frac{\mytr(\bSigma^2)}{\mytr(\bSigma)}\right)^2
    \\
    \leq&
    \frac{2n\blambda_1(\blambda_1-\blambda_p)^2}{\mytr(\bSigma)}
    .
        \end{split}
    \end{equation*}
    Thus,
    \begin{equation*}
        \mytr \left(\left(\bSigma - \frac{\mytr(\bSigma^2)}{\mytr(\bSigma)} \bI_p \right)\bP_{\bY}\right)
        =
        O_P\left(
            n(\blambda_1-\blambda_p)\sqrt{\frac{n\blambda_1}{\mytr(\bSigma)}}
        \right).
    \end{equation*}
    Then the first statement follows from the last display and \eqref{fenEq2}.

    Next we deal with $
        \mytr \left( (\bI_p-\bP_{\bY})\bSigma (\bI_p-\bP_{\bY})\right)^2
        $.
        We have
    \begin{equation*}
        \mytr \left( (\bI_p-\bP_{\bY})\bSigma (\bI_p-\bP_{\bY})\right)^2
        =
        \mytr(\bSigma^2)-2\mytr(\bSigma^2 \bP_\bY)+\mytr((\bSigma \bP_\bY)^2).
    \end{equation*}
    From von Neumann's trace theorem, the second term satisfies
    \begin{equation*}
        \left|
        \mytr(\bSigma^2 \bP_\bY)- \frac{n\mytr^2(\bSigma^2)}{\mytr^2(\bSigma)}
        \right|
        =
        \left|
        \mytr\left(
        \left(
        \bSigma^2
        -\frac{\mytr^2(\bSigma^2)}{\mytr^2(\bSigma)}\bI_p
    \right)
        \bP_\bY
    \right)
        \right|
        \leq n \blambda_1(\blambda_1-\blambda_p),
    \end{equation*}
    and the third term satisfies
    \begin{equation*}
        \begin{split}
        \left|
        \mytr((\bSigma \bP_\bY)^2)
        -\frac{n\mytr^2(\bSigma^2)}{\mytr^2(\bSigma)}
        \right|
        =&
        \left|
        \mytr\left(\left(\bSigma +\frac{\mytr(\bSigma^2)}{\mytr(\bSigma)}\bI_p\right)\bP_\bY
        \left(\bSigma -\frac{\mytr(\bSigma^2)}{\mytr(\bSigma)}\bI_p\right)\bP_\bY\right)
        \right|
        \\
        \leq &
        2n \blambda_1 (\blambda_1-\blambda_p). 
        \end{split}
    \end{equation*}
    This completes the proof of the second statement.
\end{proof}


\begin{proof}[\textbf{Proof of Theorem~\ref{fenTheorem1}}]
    In the current context, Lemma~\ref{fenLemma1} implies that
    \begin{align}
        &\mytr \left( (\bI_p-\bP_{\bY})\bSigma (\bI_p-\bP_{\bY})\right)=
        \mytr(\bSigma)-\frac{n\mytr(\bSigma^2)}{\mytr(\bSigma)}
        +o_P(\sqrt{\mytr(\bSigma^2)}),
        \label{fenEq4}
        \\
        &
        \mytr \left( (\bI_p-\bP_{\bY})\bSigma (\bI_p-\bP_{\bY})\right)^2
        =
        (1+o_P(1))
        \mytr(\bSigma^2)
        .
        \label{fenEq5}
    \end{align}
The fact $\lambda_1\left((\bI_p-\bP_\bY)\bSigma(\bI_p-\bP_\bY)\right)\leq \blambda_1$ and \eqref{fenEq5} imply that the first term of~\eqref{eq:maindec} satisfies the Lyapunov condition
\begin{equation*}
\begin{split}
\frac{\lambda_1\left((\bI_p-\bP_\bY)\bSigma(\bI_p-\bP_\bY)\right)}{\sqrt{\mytr\left(\left((\bI_p-\bP_\bY)\bSigma(\bI_p-\bP_\bY)\right)^2\right)}}
\leq &
\frac{
    \blambda_1
}{
    \sqrt{(1+o_P(1))\mytr^2(\bSigma)}
}
\xrightarrow{P} 0.
\end{split}
\end{equation*}
From Lemma \ref{CLTLEMMA}, we have
\begin{equation*}
    \frac{
    \bZ^{\dagger \top} \bLambda^{1/2}\bU^\top (\bI_p-\bP_{\bY})\bU\bLambda^{1/2}\bZ^{\dagger}
    -
        \mytr \left( (\bI_p-\bP_{\bY})\bSigma (\bI_p-\bP_{\bY})\right)
     \bI_{k-1}
 }{
     \sqrt{
        \mytr \left( (\bI_p-\bP_{\bY})\bSigma (\bI_p-\bP_{\bY})\right)^2
}
 }
\xrightarrow{\mathcal{L}} \bW_{k-1}.
\end{equation*}
Then it follows from \eqref{fenEq4}, \eqref{fenEq5} and Slutsky's theorem that
\begin{equation}
    \frac{
     \bZ^{\dagger\top} \bLambda^{1/2} \bU^\top (\bI_p-\bP_{\bY})\bU\bLambda^{1/2}\bZ^{\dagger}
 -\left(\mytr(\bSigma)-{n\mytr(\bSigma^2)}/{\mytr(\bSigma)}\right)\bI_{k-1} 
 }{
     \sqrt{\mytr(\bSigma^2)}
 }
\xrightarrow{\mathcal{L}} \bW_{k-1}.
    \label{bufenEq1}
\end{equation}

Next we consider the second term of~\eqref{eq:maindec}.
Note that 
\begin{equation*}
    \begin{split}
    \left\|
    \bC^\top \bTheta^\top (\bI_p-\bP_\bY)\bTheta \bC
    -\bC^\top \bTheta^\top\bTheta \bC
    \right\|
    =&
    \left\|
    \bC^\top \bTheta^\top \bY (\bY^\top \bY)^{-1} \bY^\top \bTheta \bC
    \right\|
    .
    \end{split}
\end{equation*}
We have
\begin{equation*}
    \begin{split}
    &\left\|
    \bC^\top \bTheta^\top \bY (\bY^\top \bY)^{-1} \bY^\top \bTheta \bC
    -{\mytr(\bSigma)}^{-1}
\bC^\top \bTheta^\top
\bY \bY^\top 
    \bTheta \bC
    \right\|
    \\
    \leq&
    \left\|
\bC^\top \bTheta^\top
 \bY \bY^\top 
    \bTheta \bC
    \right\|
    \left\|
   (\bY^\top \bY)^{-1} -{\mytr(\bSigma)}^{-1}\bI_{n}
    \right\|
    \\
    \leq&
    \left\|
{\mytr(\bSigma)}^{-1}
\bC^\top \bTheta^\top
\bY \bY^\top 
    \bTheta \bC
    \right\|
    \left\|
(\bY^\top \bY)^{-1}
    \right\|
    \left\|
   \bY^\top \bY -\mytr(\bSigma)\bI_{n}
   \right\|.
    \end{split}
\end{equation*}
From Lemma \ref{lemma:con}, we have
\begin{equation*}
    \begin{split}
    \left\|
   \bY^\top \bY -\mytr(\bSigma)\bI_{n}
   \right\|
   =&
    \left\|
   \bZ^\top \bLambda \bZ -\mytr(\bSigma)\bI_{n}
   \right\|
   \\
   =&
   O_P(\sqrt{n\mytr(\bSigma^2)}+n\blambda_1)
   \\
   =&o_P(\mytr(\bSigma))
   .
    \end{split}
\end{equation*}
   Then
   $
    \left\|
(\bY^\top \bY)^{-1}
    \right\|
    =\lambda_n^{-1}
    (\bZ^\top \bLambda \bZ)=(1+o_P(1))\mytr(\bSigma)
    $.
    Therefore,
\begin{equation*}
    \begin{split}
    &\left\|
    \bC^\top \bTheta^\top 
    \bY (\bY^\top \bY)^{-1}\bY^\top 
    \bTheta \bC
    -{\mytr(\bSigma)}^{-1}
\bC^\top \bTheta^\top
\bY \bY^\top 
\bTheta \bC
    \right\|
    \\
    =&
    o_P\left(
    \left\|
{\mytr(\bSigma)}^{-1}
\bC^\top \bTheta^\top
 \bY \bY^\top 
 \bTheta \bC
    \right\|
\right)
.
    \end{split}
\end{equation*}
Note that the columns of $
\bC^\top \bTheta^\top
 \bY  =
\bC^\top \bTheta^\top
\bU \bLambda^{1/2} \bZ$ are iid $\mathcal{N}_{k-1}(\mathbf{0}_{k-1},\bC^\top \bTheta^\top \bSigma \bTheta \bC)$ random vectors.
Hence we can write
$\bC^\top \bTheta^\top \bY = (\bC^\top \bTheta^\top \bSigma \bTheta \bC)^{1/2}\bZ^*$, where $\bZ^*$ is a $(k-1)\times n$ random matrix with iid $\mathcal{N}(0,1)$ entries.
Then
\begin{equation*}
    \begin{split}
    &\left\|
    {\mytr(\bSigma)}^{-1}
\bC^\top \bTheta^\top
\bY \bY^\top 
    \bTheta \bC
    -\frac{n}{\mytr(\bSigma)}
\bC^\top \bTheta^\top \bSigma \bTheta \bC
    \right\|
    \\
    \leq&
\frac{n}{\mytr(\bSigma)}
\left\|
\bC^\top \bTheta^\top \bSigma \bTheta \bC
    \right\|
    \left\|
    n^{-1}\bZ^* \bZ^{*\top}
    -\bI_{k-1}
    \right\|
\\
=&o_P\left(
\frac{n}{\mytr(\bSigma)}
\left\|
\bC^\top \bTheta^\top \bSigma \bTheta \bC
    \right\|
\right),
    \end{split}
\end{equation*}
where the last equality follows from the law of large numbers.
Combine the above arguments, we have
\begin{equation}\label{bufenEq2}
    \begin{split}
    \left\|
    \bC^\top \bTheta^\top (\bI_p-\bP_\bY)\bTheta \bC
    -
    \bC^\top \bTheta^\top \bTheta \bC
    \right\|
    = &
    \left(1+o_P\left(1\right)\right)
\frac{n}{\mytr(\bSigma)}
\left\|
\bC^\top \bTheta^\top \bSigma \bTheta \bC
    \right\|
\\
\leq&
    \left(1+o_P\left(1\right)\right)
\frac{n\blambda_1}{\mytr(\bSigma)}
\left\|
\bC^\top \bTheta^\top \bTheta \bC
\right\|
\\
=&
o_P\left(
    \sqrt{\mytr(\bSigma^2)}
\right)
.
    \end{split}
\end{equation}




Now we deal with the cross term of~\eqref{eq:maindec}. Note that
$$
\begin{aligned}
    \myE [\|\bC^\top \bTheta^\top (\bI_p -\bP_{\bY})\bU\bLambda^{1/2}\bZ^{\dagger}\|_F^2|\bY]
    = &
    (k-1)\mytr\left(\bC^\top \bTheta^\top (\bI_p -\bP_{\bY})\bSigma (\bI_p -\bP_{\bY})\bTheta \bC\right)\\
    \leq &
    (k-1)\blambda_1
    \mytr\left(\bC^\top \bTheta^\top \bTheta \bC\right).
\end{aligned}
$$
Therefore,
\begin{equation}\label{bufenEq3}
    \begin{split}
\|\bC^\top \bTheta^\top (\bI_p -\bP_{\bY})\bU\bLambda^{1/2}\bZ^{\dagger}\|
=&O_P\left(
    \sqrt{
        \blambda_1
    \mytr\left(\bC^\top \bTheta^\top \bTheta \bC\right)
}
\right)
\\
=&o_P\left(\sqrt{\mytr(\bSigma^2)}\right),
    \end{split}
\end{equation}
where the last equality follows from the conditions $\blambda_1/\sqrt{\mytr(\bSigma^2)}\to 0$ and 
$
    \mytr\left(\bC^\top \bTheta^\top \bTheta \bC\right)
    \leq (k-1)
    \left\|\bC^\top \bTheta^\top \bTheta \bC\right\|=O(\sqrt{\mytr(\bSigma^2)})
    $.

It follows from \eqref{bufenEq2}, \eqref{bufenEq3} and Weyl's inequality that
\begin{equation*}
    \begin{split}
        &\left|
        T(\bX)-
        \left(
        \lambda_1\left(
\bZ^{\dagger \top} \bLambda^{1/2}\bU^\top (\bI_p-\bP_{\bY})\bU\bLambda^{1/2}\bZ^{\dagger}+
 \bC^\top \bTheta^\top \bTheta \bC
        \right)
    \right)
        \right|
        \\
        \leq
        &
 \left\|
 \bC^\top \bTheta^\top (\bI_p -\bP_{\bY})\bTheta \bC
 -
 \bC^\top \bTheta^\top \bTheta \bC
 +
  \bC^\top \bTheta^\top (\bI_p -\bP_{\bY})\bU\bLambda^{1/2}\bZ^{\dagger}+
 \bZ^{\dagger \top} \bLambda^{1/2}\bU^\top (\bI_p-\bP_{\bY})\bTheta \bC
 \right\|
 \\
 \leq&
 \left\|
 \bC^\top \bTheta^\top (\bI_p -\bP_{\bY})\bTheta \bC
 -
 \bC^\top \bTheta^\top \bTheta \bC
 \right\|
 +
 2\left\|
  \bC^\top \bTheta^\top (\bI_p -\bP_{\bY})\bU\bLambda^{1/2}\bZ^{\dagger}
 \right\|
 \\
=&o_P\left(
\sqrt{\mytr(\bSigma^2)}
\right)
 .
    \end{split}
\end{equation*}
But \eqref{bufenEq1} implies that
\begin{equation*}
    \begin{split}
&\frac{
        \lambda_1\left(
\bZ^{\dagger \top} \bLambda^{1/2}\bU^\top (\bI_p-\bP_{\bY})\bU\bLambda^{1/2}\bZ^{\dagger}+
 \bC^\top \bTheta^\top \bTheta \bC
 \right)
 -\left(\mytr(\bSigma)-{n\mytr(\bSigma^2)}/{\mytr(\bSigma)}\right)
 }{
     \sqrt{\mytr(\bSigma^2)}
 }
 \\
    =&
    \lambda_1\left(
    \frac{
     \bZ^{\dagger\top} \bLambda^{1/2} \bU^\top (\bI_p-\bP_{\bY})\bU\bLambda^{1/2}\bZ^{\dagger}
 -\left(\mytr(\bSigma)-{n\mytr(\bSigma^2)}/{\mytr(\bSigma)}\right)\bI_{k-1} 
 }{
     \sqrt{\mytr(\bSigma^2)}
 }
 +
 \frac{\bC^\top \bTheta^\top \bTheta \bC}{
     \sqrt{\mytr(\bSigma^2)}
 }
 \right)
 \\
 \sim& \lambda_1\left(\bW_{k-1}+
 \frac{\bC^\top \bTheta^\top \bTheta \bC}{
     \sqrt{\mytr(\bSigma^2)}
 }
 \right)+o_P(1).
    \end{split}
\end{equation*}
This completes the proof.

    
\end{proof}
\begin{proof}[\textbf{Proof of Corollary \ref{kuCor1}}]
It is straightforward to show that 
$\myE \widehat{\mytr(\bSigma)}=\mytr(\bSigma)$ and 
$\myVar \left(\widehat{\mytr(\bSigma)}\right)=2n^{-1}\mytr(\bSigma^2)$.
Then
$\widehat{\mytr(\bSigma)}=\mytr(\bSigma)+O_P(\sqrt{n^{-1}\mytr(\bSigma^2)})$.
Let $Z_1,\ldots, Z_n$ be the columns of $\bZ$.
Then we have
\begin{equation*}
    \begin{split}
\widehat{\mytr(\bSigma^2)}=&
n^{-2} \mytr(\bZ^\top \bLambda \bZ-n^{-1}\mytr(\bZ^\top \bLambda \bZ)\bI_n)^2
\\
=&
n^{-2} \sum_{i=1}^n (Z_{i}^\top \bLambda Z_i - n^{-1}\sum_{i=1}^n Z_{i}^\top \bLambda Z_i)^2
+
2n^{-2} \sum_{1\leq i < j \leq n} (Z_i^\top \bLambda Z_i)^2.
    \end{split}
\end{equation*}
It can be seen that
$
n^{-2} \sum_{i=1}^n (Z_{i}^\top \bLambda Z_i - n^{-1}\sum_{i=1}^n Z_{i}^\top \bLambda Z_i)^2
=O_P(n^{-1}\mytr(\bSigma^2))
$.
    On the other hand, we have $
\myE 2 \sum_{1\leq i < j \leq n} (Z_i^\top \bLambda Z_i)^2
=n(n-1)\mytr(\bSigma^2)
$.
    Furthermore, \cite{chen2010tests}, Proposition A.2 implies that
    \begin{equation*}
        \myVar\left(
            2\sum_{1\leq i<j\leq n} (Z_{i}^\top \bLambda Z_{j})^2
        \right)
        = O\left(
            n^2 \mytr^2 (\bSigma^2) + n^3 \mytr(\bSigma^4)
        \right)
        = O\left(
            n^3 \mytr^2 (\bSigma^2) 
        \right)
        .
    \end{equation*}
Hence $
\widehat{\mytr(\bSigma^2)}
= (1+O_P(n^{-1/2}))\mytr(\bSigma^2) 
$.

Thus, we have
\begin{equation*}
    \begin{split}
    &\widehat{\mytr(\bSigma)}-n\widehat{\mytr(\bSigma^2)}/\widehat{\mytr(\bSigma)}
    \\
    =
    &\mytr(\bSigma) +O_P(\sqrt{n^{-1}\mytr(\bSigma^2)})
    -\frac{n\mytr(\bSigma^2)(1+O_P(n^{-1/2}))}{\mytr(\bSigma)(1+O_P(\sqrt{n^{-1}\mytr(\bSigma^2)/\mytr^2(\bSigma)}))}
    \\
    =
    &\mytr(\bSigma) +O_P(\sqrt{n^{-1}\mytr(\bSigma^2)})
    -\frac{n\mytr(\bSigma^2)}{\mytr(\bSigma)}
    \left(1+O_P \left(\frac{1}{\sqrt{n}}+\sqrt{\frac{\mytr(\bSigma^2)}{n\mytr^2(\bSigma)}}\right)\right)
    \\
    =
    &\mytr(\bSigma)
    -\frac{n\mytr(\bSigma^2)}{\mytr(\bSigma)}
    +o_P(\sqrt{\mytr(\bSigma^2)}).
    \\
    \end{split}
\end{equation*}
Therefore,
\begin{equation*}
    Q_1=
        \frac{T(\bX)-\left(\mytr(\bSigma)-n\mytr(\bSigma^2)/\mytr(\bSigma)\right)}{\sqrt{\mytr(\bSigma^2)}}
        +o_P(1).
\end{equation*}
Then the conclusion follows from Theorem \ref{fenTheorem1}.
\end{proof}









\begin{lemma}\label{gg:Lemma1}
    Suppose that
    $r=o(n)$, $\mytr(\bLambda_2)\blambda_1/(n\blambda_r^2)\to 0$,
    $n\blambda_{r+1}/\mytr(\bLambda_2)\to 0$.
    Then uniformly for $i=1,\ldots, r$,
\begin{equation*}
    \lambda_i\left(
             (\bI_p -\bP_\bY)\bSigma (\bI_p- \bP_{\bY})
         \right)
         =
             n^{-1}\mytr(\bLambda_2)
             \left(1
             +O_P\left(
                     \sqrt{\frac{\mytr(\bLambda_2)\blambda_1}{n\blambda_r^2}}  
                     +\sqrt{\frac{n\blambda_{r+1}}{\mytr(\bLambda_2)}}
                     +\sqrt{\frac{r}{n}}
             \right)
         \right)
             .
\end{equation*}

\end{lemma}
\begin{proof}
    Note that
    \begin{equation}\label{cho111}
         (\bI_p-\bP_{\bY})\bSigma (\bI_p-\bP_{\bY})
         =
         (\bI_p-\bP_{\bY,2})
         (\bI_p-\bP_{\bY,1})
         \bSigma 
         (\bI_p-\bP_{\bY,1})
         (\bI_p-\bP_{\bY,2}).
    \end{equation}
We first deal with
    $
         (\bI_p-\bP_{\bY,1})
         \bSigma 
         (\bI_p-\bP_{\bY,1})
         $.
Under the condition $n\blambda_{r+1}/\mytr(\bLambda_2)\to 0$, Proposition~\ref{newEigenvectorPropCor} implies that
\begin{equation*}
        \|\bU_{\bY,1}\bU_{\bY,1}^\top - 
\bP^\dagger_{\bY,1}
        \|
    =O_P\left(\frac{\mytr(\bLambda_2)}{n\blambda_r}\right).
\end{equation*}
    From the decomposition
         \begin{equation*}
         \begin{split}
         (\bI_p-\bP_{\bY,1})
         \bSigma 
         (\bI_p-\bP_{\bY,1})
         =&
         (\bI_p-\bP_{\bY,1}^{\dagger})
         \bSigma 
         (\bI_p-\bP_{\bY,1}^{\dagger})
         +
         (\bP_{\bY,1}^{\dagger}-\bP_{\bY,1})
         \bSigma 
         (\bI_p-\bP_{\bY,1}^{\dagger})
         \\
         &+
         (\bI_p-\bP_{\bY,1}^{\dagger})
         \bSigma 
         (\bP_{\bY,1}^{\dagger}-\bP_{\bY,1})
         +
         (\bP_{\bY,1}^{\dagger}-\bP_{\bY,1})
         \bSigma 
         (\bP_{\bY,1}^{\dagger}-\bP_{\bY,1}),
         \end{split}
         \end{equation*}
we have
         \begin{equation*}
         \begin{split}
         &\left\|
         (\bI_p-\bP_{\bY,1})
         \bSigma 
         (\bI_p-\bP_{\bY,1})
         -
         (\bI_p-\bP_{\bY,1}^{\dagger})
         \bSigma 
         (\bI_p-\bP_{\bY,1}^{\dagger})
         \right\|
         \\
         \leq&
         2
         \left\|\bP_{\bY,1}^{\dagger}-\bP_{\bY,1}\right\|
         \left\|\bSigma 
         (\bI_p-\bP_{\bY,1}^{\dagger})\right\|
         +
         \blambda_1\|\bP_{\bY,1}^{\dagger}-\bP_{\bY,1}\|^2.
         \\
         = &
         O_P\left(\frac{\mytr(\bLambda_2)}{n\blambda_r}\right)
         \left\|\bSigma 
         (\bI_p-\bP_{\bY,1}^{\dagger})\right\|
         +
         O_P\left(\frac{\mytr^2(\bLambda_2)\blambda_1}{n^2\blambda_r^2}\right)
         .
         \end{split}
         \end{equation*}
Note that
\begin{equation*}
    \begin{split}
         \left\|\bSigma 
         (\bI_p-\bP_{\bY,1}^{\dagger})\right\|
         =&
         \left\|
         \bU_2 \bLambda_2 \bU_2^\top
         -\bU_1 \bLambda_1 \bQ^\top \bU_2^\top
         -\bU_2 \bLambda_2 \bQ \bU_1^\top
         \right\|
         \\
         \leq &
         \blambda_{r+1}
         +
         \left\|
          \bLambda_1 \bQ^\top
          \right\|
          +
          \blambda_{r+1}
          \left\|
          \bQ 
         \right\|
         \\
         = &
         \blambda_{r+1}
         +
         \left\|
         \bLambda_1^{1/2} (\bZ_1 \bZ_1^\top)^{-1/2} \bV_{\bZ_1}^\top \bZ_2^\top \bLambda_2^{1/2}
         \right\|
         +
         \blambda_{r+1}\|\bQ^\top \bQ\|^{1/2}
         \\
         \leq &
         \blambda_{r+1}
         +
         \blambda_1^{1/2}
         \left\|
        (\bZ_1 \bZ_1^\top)^{-1/2}
         \right\|
         \left\|
         \bV_{\bZ_1}^\top \bZ_2^\top \bLambda_2 \bZ_2 \bV_{\bZ_1}
         \right\|^{1/2}
         +
         \blambda_{r+1}\|\bQ^\top \bQ\|^{1/2}
         \\
         =&
         O_P\left(\sqrt{\frac{\mytr(\bLambda_2)\blambda_1}{n}}\right),
    \end{split}
\end{equation*}
where the last equality follows from~\eqref{projCon},~\eqref{UpperBoundQ} and the condition $n\blambda_{r+1}/\mytr(\bLambda_2)\to 0$.
Thus,
\begin{equation}\label{choc1}
         \left\|
         (\bI_p-\bP_{\bY,1})
         \bSigma 
         (\bI_p-\bP_{\bY,1})
         -
         (\bI_p-\bP_{\bY,1}^{\dagger})
         \bSigma 
         (\bI_p-\bP_{\bY,1}^{\dagger})
         \right\|
         = 
         O_P\left(\frac{\mytr^{3/2}(\bLambda_2)\blambda_1^{1/2}}{n^{3/2}\blambda_r}\right)
         .
         \end{equation}

         From the decomposition
         \begin{equation*}
             \begin{split}
         &(\bI_p-\bP_{\bY,1}^{\dagger})
         \bSigma 
         (\bI_p-\bP_{\bY,1}^{\dagger})
         \\
             =&
             \bU_2\bQ \bLambda_1 \bQ^\top \bU_2^\top 
             +\bU_2\bLambda_2  \bU_2^\top
             -\bU_2 \bLambda_2 \bQ \bU_1^\top
             -\bU_1 \bQ^\top \bLambda_2 \bU_2^\top
             +\bU_1 \bQ^\top \bLambda_2 \bQ \bU_1^\top,
             \end{split}
         \end{equation*}
         we have
         \begin{equation}\label{choc2}
             \begin{split}
         \left\|
         (\bI_p-\bP_{\bY,1}^{\dagger})
         \bSigma 
         (\bI_p-\bP_{\bY,1}^{\dagger})
             -
             \bU_2 \bQ \bLambda_1 \bQ^\top  \bU_2^\top
             \right\|
             \leq &
             \blambda_{r+1}(1+2\|\bQ^\top \bQ\|^{1/2}+\|\bQ^\top \bQ\|)
             \\
             = &
             O_P\left(\blambda_{r+1}\right)
             ,
             \end{split}
         \end{equation}
         where the last equality follows from~\eqref{UpperBoundQ}.
         Note that
         $
             \bU_2\bQ \bLambda_1 \bQ^\top\bU_2^\top
             =
             \bU_2 \bLambda_2^{1/2} \bZ_2 \bV_{\bZ_1} (\bZ_1 \bZ_1^\top)^{-1}\bV_{\bZ_1}^\top \bZ_2^\top \bLambda_2^{1/2} \bU_2^\top$. 
             We have
     \begin{equation} \label{choc6}
     \begin{split}
             &\left\|\bU_2\bQ \bLambda_1 \bQ^\top\bU_2^\top
             -
             n^{-1} \bU_2 \bLambda_2^{1/2} \bZ_2 \bV_{\bZ_1} \bV_{\bZ_1}^\top \bZ_2^\top \bLambda_2^{1/2} \bU_2^\top
             \right\|
             \\
             \leq&
             \left\|\bU_2 \bLambda_2^{1/2} \bZ_2 \bV_{\bZ_1}\bV_{\bZ_1}^\top \bZ_2^\top \bLambda_2^{1/2} \bU_2^\top\right\|
             \left\|(\bZ_1 \bZ_1^\top)^{-1} - n^{-1} \bI_r\right\|
                  \\
            \leq&
             \left\|\bV_{\bZ_1}^\top \bZ_2^\top \bLambda_2 \bZ_2 \bV_{\bZ_1}\right\|
                  \left\|(\bZ_1 \bZ_1^\top)^{-1}\right\|
                  \left\|n^{-1}\bZ_1 \bZ_1^\top -\bI_r\right\|
                  \\
                  =&
                  O_P\left(\frac{r^{1/2}\mytr(\bLambda_2)}{n^{3/2}}\right),
     \end{split}
 \end{equation}
where the last equality follows from~\eqref{conB2B1} and~\eqref{projCon}.
From \eqref{cho111}, \eqref{choc1}, \eqref{choc2} and \eqref{choc6}, we obtain that
         \begin{equation*}
             \begin{split}
             &\left\|
             (\bI_p -\bP_\bY)\bSigma (\bI_p- \bP_{\bY})
             -
             n^{-1}
             (\bI_p -\bP_{\bY,2})
              \bU_2 \bLambda_2^{1/2} \bZ_2 \bV_{\bZ_1} \bV_{\bZ_1}^\top \bZ_2^\top \bLambda_2^{1/2} \bU_2^\top
             (\bI_p- \bP_{\bY,2})
             \right\|
             \\
             =&
             O_P\left(
                 \left(
                     \sqrt{\frac{\mytr(\bLambda_2)\blambda_1}{n\blambda_r^2}}  
                     +\frac{n\blambda_{r+1}}{\mytr(\bLambda_2)}
                     +\sqrt{\frac{r}{n}}
                 \right)
             \frac{\mytr(\bLambda_2)}{n}\right).
             \end{split}
         \end{equation*}

         Thus, the last display, together with Weyl's inequality, implies that uniformly for $i=1,\ldots, r$,
\begin{equation*}
    \begin{split}
    \lambda_i\left(
             (\bI_p -\bP_\bY)\bSigma (\bI_p- \bP_{\bY})
         \right)
             =&
             n^{-1}\lambda_i\left(
                  \bV_{\bZ_1}^\top \bZ_2^\top \bLambda_2^{1/2} \bU_2^\top (\bI-\bP_{\bY,2}) \bU_2 \bLambda_2^{1/2} \bZ_2 \bV_{\bZ_1}
              \right)
              \\
             &+O_P\left(
                 \left(
                     \sqrt{\frac{\mytr(\bLambda_2)\blambda_1}{n\blambda_r^2}}  
                     +\frac{n\blambda_{r+1}}{\mytr(\bLambda_2)}
                     +\sqrt{\frac{r}{n}}
                 \right)
             \frac{\mytr(\bLambda_2)}{n}\right).
    \end{split}
\end{equation*}
Note that
\begin{equation*}
    \begin{split}
                  &\left\|
                  n^{-1}\bV_{\bZ_1}^\top \bZ_2^\top \bLambda_2^{1/2} \bU_2^\top (\bI-\bP_{\bY,2}) \bU_2 \bLambda_2^{1/2} \bZ_2 \bV_{\bZ_1}
              \right.
              \\
              &\left.
                  -\left(
                      n^{-1}\mytr(\bLambda_2)\bI_r
                  -
            \left(n\mytr(\bLambda_2)\right)^{-1}
            \bV_{\bZ_1}^\top \bZ_2^\top \bLambda_2\bZ_{2} \tilde{\bV}_{\bZ_1}
            \tilde{\bV}_{\bZ_1}^\top \bZ_2^\top \bLambda_2 \bZ_2 \bV_{\bZ_1}
                  \right)
                  \right\|
                  \\
                  \leq&
                  \left\|n^{-1}\bV_{\bZ_1}^\top \bZ_2^\top \bLambda_2 \bZ_2 \bV_{\bZ_1}-
                      n^{-1}\mytr(\bLambda_2)\bI_r
                  \right\|
                  \\
                  &+
                  n^{-1}\left\|\bV_{\bZ_1}^\top \bZ_2^\top \bLambda_2 \bZ_2 \bV_{\bZ_1}\right\|
            \left\|\bP_{\bY,2}-
            \left(\mytr(\bLambda_2)\right)^{-1}
            \bLambda_2^{1/2}\bZ_{2} \tilde{\bV}_{\bZ_1}
            \tilde{\bV}_{\bZ_1}^\top \bZ_2^\top \bLambda_2^{1/2}
            \right\|
            \\
            =& O_P\left(
                \left(
                    \sqrt{\frac{\mytr(\bLambda_2)\blambda_1}{n\blambda_r^2}}
                    +
            \sqrt{\frac{n\blambda_{r+1}}{\mytr(\bLambda_2)}}
        \right)
            \frac{\mytr(\bLambda_2)}{n}\right)
            ,
    \end{split}
\end{equation*}
where the last equality follows from \eqref{projCon} and Proposition~\ref{eigenvectorprop3}.
Then it follows from Weyl's inequality that uniformly for $i=1,\ldots, r$,
\begin{equation}\label{choc3}
    \begin{split}
    &\lambda_i\left(
             (\bI_p -\bP_\bY)\bSigma (\bI_p- \bP_{\bY})
         \right)
         \\
             =&
             n^{-1}\mytr(\bLambda_2)
             -
             \left(n\mytr(\bLambda_2)\right)^{-1}
                 \lambda_{r+1-i}\left(
            \bV_{\bZ_1}^\top \bZ_2^\top \bLambda_2\bZ_{2} \tilde{\bV}_{\bZ_1}
            \tilde{\bV}_{\bZ_1}^\top \bZ_2^\top \bLambda_2 \bZ_2 \bV_{\bZ_1}
                 \right) 
              \\
             &+O_P\left(
                 \left(
                     \sqrt{\frac{\mytr(\bLambda_2)\blambda_1}{n\blambda_r^2}}  
                     +\sqrt{\frac{n\blambda_{r+1}}{\mytr(\bLambda_2)}}
                     +\sqrt{\frac{r}{n}}
                 \right)
             \frac{\mytr(\bLambda_2)}{n}\right).
    \end{split}
\end{equation}
Now we deal with the matrix $
            \bV_{\bZ_1}^\top \bZ_2^\top \bLambda_2\bZ_{2} \tilde{\bV}_{\bZ_1}
            \tilde{\bV}_{\bZ_1}^\top \bZ_2^\top \bLambda_2 \bZ_2 \bV_{\bZ_1}
            $.
            Note that
            $\bZ_2\bV_{\bZ_1}$
            and
            $\bZ_2\tilde{\bV}_{\bZ_1}$
            both have iid $\mathcal{N}(0,1)$ entries and they are mutually independent.
            Then Lemma~\ref{lemma:con} implies that
    \begin{equation*}
        \begin{split}
            &\left\|
            \bV_{\bZ_1}^\top \bZ_2^\top \bLambda_2\bZ_{2} \tilde{\bV}_{\bZ_1}
            \tilde{\bV}_{\bZ_1}^\top \bZ_2^\top \bLambda_2 \bZ_2 \bV_{\bZ_1}
            -
            \mytr(\bLambda_2\bZ_{2} \tilde{\bV}_{\bZ_1}
            \tilde{\bV}_{\bZ_1}^\top \bZ_2^\top \bLambda_2) 
            \bI_r
            \right\|
            \\
            =&
            O_P\left(
                \sqrt{
                    r
            \mytr(\bLambda_2\bZ_{2} \tilde{\bV}_{\bZ_1}
            \tilde{\bV}_{\bZ_1}^\top \bZ_2^\top \bLambda_2)^2 
                }
                +r
            \left\|
            \bLambda_2\bZ_{2} \tilde{\bV}_{\bZ_1}
            \tilde{\bV}_{\bZ_1}^\top \bZ_2^\top \bLambda_2
            \right\|
        \right)
        .
        \end{split}
    \end{equation*}
By some algebra, we have
    \begin{equation*}
        \begin{split}
            &\left\|
            \bV_{\bZ_1}^\top \bZ_2^\top \bLambda_2\bZ_{2} \tilde{\bV}_{\bZ_1}
            \tilde{\bV}_{\bZ_1}^\top \bZ_2^\top \bLambda_2 \bZ_2 \bV_{\bZ_1}
            -
            \mytr(
            \tilde{\bV}_{\bZ_1}^\top \bZ_2^\top \bLambda_2^2
                \bZ_{2} \tilde{\bV}_{\bZ_1}
        ) 
            \bI_r
            \right\|
            \\
            =&
            O_P\left(
                \sqrt{
                    r
            \left\|
            \tilde{\bV}_{\bZ_1}^\top \bZ_2^\top \bLambda_2^2 \bZ_{2} \tilde{\bV}_{\bZ_1}
            \right\|
            \mytr(
            \tilde{\bV}_{\bZ_1}^\top \bZ_2^\top \bLambda_2^2\bZ_{2} \tilde{\bV}_{\bZ_1})
                }
                +r
            \left\|
            \tilde{\bV}_{\bZ_1}^\top \bZ_2^\top \bLambda_2^2
            \bZ_{2} \tilde{\bV}_{\bZ_1}
            \right\|
        \right)
        .
        \end{split}
    \end{equation*}
    Since
    $
        \myE \mytr(
            \tilde{\bV}_{\bZ_1}^\top \bZ_2^\top \bLambda_2^2\bZ_{2} \tilde{\bV}_{\bZ_1})
            =(n-r)\mytr(\bLambda_2^2)
            $,
we have 
\begin{equation*}
\mytr(
\tilde{\bV}_{\bZ_1}^\top \bZ_2^\top \bLambda_2^2\bZ_{2} \tilde{\bV}_{\bZ_1})=
O_P\left(n\mytr(\bLambda_2^2)\right)
=
O_P\left(n\blambda_{r+1}\mytr(\bLambda_2)\right)
.
\end{equation*}
On the other hand, Lemma~\ref{lemma:con} implies that
\begin{equation*}
        \|
            \tilde{\bV}_{\bZ_1}^\top \bZ_2^\top \bLambda_2^2\bZ_{2} \tilde{\bV}_{\bZ_1}
            \|
            =O_P\left(\mytr(\bLambda_2^2)+n\blambda_{r+1}^2\right)
            =O_P\left(\blambda_{r+1}\mytr(\bLambda_2)\right)
            .
\end{equation*}
Combine these bounds, we have
    \begin{equation*}
        \begin{split}
            &\left\|
            \bV_{\bZ_1}^\top \bZ_2^\top \bLambda_2\bZ_{2} \tilde{\bV}_{\bZ_1}
            \tilde{\bV}_{\bZ_1}^\top \bZ_2^\top \bLambda_2 \bZ_2 \bV_{\bZ_1}
            -
            n\mytr(\bLambda_2^2)
            \bI_r
            \right\|
            =
            O_P\left(
                \sqrt{rn}\blambda_{r+1}\mytr(\bLambda_2)
        \right)
        .
        \end{split}
    \end{equation*}
    The last display, combined with Weyl's inequality, implies that uniformly for $i=1,\ldots, r$,
    \begin{equation*}
        (n\mytr(\bLambda_2))^{-1}\lambda_i\left(
            \bV_{\bZ_1}^\top \bZ_2^\top \bLambda_2\bZ_{2} \tilde{\bV}_{\bZ_1}
            \tilde{\bV}_{\bZ_1}^\top \bZ_2^\top \bLambda_2 \bZ_2 \bV_{\bZ_1}
        \right)
        =
        %\frac{ \mytr(\bLambda_2^2) }{\mytr(\bLambda_2)}+O_P\left(\sqrt{\frac{r}{n}}\blambda_{r+1}\right)
        O_P(\blambda_{r+1})
        .
    \end{equation*}
    Then~\eqref{choc3} and the last display implies that uniformly for $i=1,\ldots,r$,
\begin{equation*}
    \begin{split}
    &\lambda_i\left(
             (\bI_p -\bP_\bY)\bSigma (\bI_p- \bP_{\bY})
         \right)
         \\
             =&
             n^{-1}\mytr(\bLambda_2)
             %-\frac{\mytr(\bLambda_2^2)}{\mytr(\bLambda_2)}
             +O_P\left(
                 \left(
                     \sqrt{\frac{\mytr(\bLambda_2)\blambda_1}{n\blambda_r^2}}  
                     +\sqrt{\frac{n\blambda_{r+1}}{\mytr(\bLambda_2)}}
                     +\sqrt{\frac{r}{n}}
                 \right)
             \frac{\mytr(\bLambda_2)}{n}\right).
    \end{split}
\end{equation*}
This completes the proof.

\end{proof}

\begin{lemma}\label{gg:Lemmac}
    Suppose that
    $r=o(n)$, $\mytr(\bLambda_2)\blambda_1/(n\blambda_r^2)\to 0$,
    $n\blambda_{r+1}/\mytr(\bLambda_2)\to 0$.
    Then
\begin{equation*}
    \begin{split}
        &
        \sum_{i=r+1}^{p}\lambda_i\left(
         (\bI_p -\bP_\bY)\bSigma (\bI_p- \bP_{\bY})
    \right)
    \\
    =&\mytr(\bLambda_2)-\frac{n\mytr(\bLambda_2^2)}{\mytr(\bLambda_2)}
    +
    O_P\left(n(\blambda_{r+1}-\blambda_p)\left(\sqrt{\frac{\mytr(\bLambda_2)\blambda_1}{n\blambda_r^2}}+\sqrt{\frac{n\blambda_{r+1}}{\mytr(\bLambda_2)}}\right)
    +r\blambda_{r+1}
    \right).
    \end{split}
\end{equation*}
\end{lemma}
\begin{proof}
    Write $\bSigma=\bU_1 \bLambda_1 \bU_1^\top+\bU_2 \bLambda_2 \bU_2^\top$.
    Note that $\bU_1 \bLambda_1 \bU_1^\top$ is of rank $r$.
    Then Weyl's inequality implies that for $i=r+1,\ldots,p$, 
    \begin{align}
        \label{yanyan1}
    &\lambda_i \left(
         (\bI_p -\bP_\bY)\bSigma (\bI_p- \bP_{\bY})
    \right)
    \geq
    \lambda_i \left(
         (\bI_p -\bP_\bY)\bU_2 \bLambda_2 \bU_2^\top (\bI_p- \bP_{\bY})
     \right),
     \\
     \label{yanyan2}
     &
    \lambda_i \left(
         (\bI_p -\bP_\bY)\bSigma (\bI_p- \bP_{\bY})
    \right)
    \leq
    \lambda_{i-r} \left(
         (\bI_p -\bP_\bY)\bU_2 \bLambda_2 \bU_2^\top (\bI_p- \bP_{\bY})
     \right).
    \end{align}
    Hence we have
    \begin{equation}\label{jojo2}
        \begin{split}
        &\left|
        \sum_{i=r+1}^{p}\lambda_i\left(
         (\bI_p -\bP_\bY)\bSigma (\bI_p- \bP_{\bY})
    \right)
    -
        \mytr\left(
         (\bI_p -\bP_\bY)\bU_2 \bLambda_2 \bU_2^\top (\bI_p- \bP_{\bY})
    \right)
    \right|
    \\
    \leq&
    r\lambda_1 \left(
         (\bI_p -\bP_\bY)\bU_2 \bLambda_2 \bU_2^\top (\bI_p- \bP_{\bY})
    \right)
    \\
    \leq & r \blambda_{r+1}.
        \end{split}
    \end{equation}
    Write
    \begin{equation}\label{jojoa}
        \begin{split}
        &\mytr\left(
         (\bI_p -\bP_\bY)\bU_2 \bLambda_2 \bU_2^\top (\bI_p- \bP_{\bY})
    \right)
    \\
    =&
        \mytr\left(
          \bLambda_2 \bU_2^\top (\bI_p- \bP_{\bY})\bU_2 
    \right)
    \\
    =&
    \mytr(\bLambda_2)
    -
        \mytr\left(
            \left(\bLambda_2-\frac{\mytr(\bLambda_2^2)}{\mytr(\bLambda_2)}\bI_{p-r}\right) \bU_2^\top \bP_{\bY} \bU_2 
    \right)
    -
    \frac{\mytr(\bLambda_2^2)}{\mytr(\bLambda_2)}
        \mytr\left(
           \bU_2^\top \bP_{\bY} \bU_2 
       \right).
        \end{split}
    \end{equation}
    For the third term, note that
    $
        \mytr\left(
           \bU_2^\top \bP_{\bY} \bU_2 
       \right)
       =
       \mytr(\bP_\bY)
       -
        \mytr\left(
            \bP_{\bY} \bU_1 \bU_1^\top
       \right)
       $.
       Since $\bP_{\bY}$ is of rank $n$ and $\bU_1$ is of rank $r$, we have
       \begin{equation}\label{ranklr}
       |
        \mytr\left(
           \bU_2^\top \bP_{\bY} \bU_2 
       \right)
       -
       n
       |
       \leq r
       .
       \end{equation}
       Next we deal with the second term.
       We have
       \begin{equation*}
           \begin{split}
        &\left|
        \mytr\left(
            \left(\bLambda_2-\frac{\mytr(\bLambda_2^2)}{\mytr(\bLambda_2)}\bI_{p-r}\right) \bU_2^\top \bP_{\bY} \bU_2 
    \right)
    -
        \mytr\left(
            \left(\bLambda_2-\frac{\mytr(\bLambda_2^2)}{\mytr(\bLambda_2)}\bI_{p-r}\right) \bU_2^\top \left(\bP_{\bY,1}^\dagger+\bP_{\bY,2}^\dagger\right) \bU_2 
    \right)
    \right|\\
    =&
    \left|
        \mytr\left(
            \left(\bLambda_2-\frac{\mytr(\bLambda_2^2)}{\mytr(\bLambda_2)}\bI_{p-r}\right) \bU_2^\top \left(\bP_{\bY}-\bP_{\bY,1}^\dagger-\bP_{\bY,2}^\dagger\right) \bU_2 
    \right)
    \right|.
           \end{split}
       \end{equation*}
       Since ${\mytr(\bLambda_2^2)}/{\mytr(\bLambda_2)}\in[\blambda_{p},\blambda_{r+1}]$, we have
       $\|\bLambda_2-({\mytr(\bLambda_2^2)}/{\mytr(\bLambda_2)})\bI_{p-r}\|\leq \blambda_{r+1}-\blambda_p$.
       Also note that the rank of the matrix $\bP_{\bY}-\bP_{\bY,1}^\dagger-\bP_{\bY,2}^\dagger$ is at most $2n$.
       Therefore, von Neumann's trace theorem implies that
       \begin{equation}\label{jojo1}
           \begin{split}
    &\left|
        \mytr\left(
            \left(\bLambda_2-\frac{\mytr(\bLambda_2^2)}{\mytr(\bLambda_2)}\bI_{p-r}\right) \bU_2^\top \left(\bP_{\bY}-\bP_{\bY,1}^\dagger-\bP_{\bY,2}^\dagger\right) \bU_2 
    \right)
    \right|
    \\
    \leq & 2n (\blambda_{r+1} -\blambda_p)\left\|\bP_{\bY}-\bP_{\bY,1}^\dagger-\bP_{\bY,2}^\dagger\right\|
    \\
    \leq & 2n (\blambda_{r+1} -\blambda_p)\left(
        \left\|\bP_{\bY,1}-\bP_{\bY,1}^\dagger\right\|
        +\left\|\bP_{\bY,2}-\bP_{\bY,2}^\dagger
        \right\|
    \right)
    \\
    =&
    O_P\left(n(\blambda_{r+1}-\blambda_p)\left(\sqrt{\frac{\mytr(\bLambda_2)\blambda_1}{n\blambda_r^2}}+\sqrt{\frac{n\blambda_{r+1}}{\mytr(\bLambda_2)}}\right)\right),
           \end{split}
       \end{equation}
       where the last equality follows from Proposition~\ref{newEigenvectorPropCor} and Proposition~\ref{eigenvectorprop3}.
       Note that
       \begin{equation*}
           \begin{split}
        &
        \mytr\left(
            \left(\bLambda_2-\frac{\mytr(\bLambda_2^2)}{\mytr(\bLambda_2)}\bI_{p-r}\right) \bU_2^\top \left(\bP_{\bY,1}^\dagger+\bP_{\bY,2}^\dagger\right) \bU_2 
    \right)
    \\
        =&
        \mytr\left(
            \left(\bLambda_2-\frac{\mytr(\bLambda_2^2)}{\mytr(\bLambda_2)}\bI_{p-r}\right) \bU_2^\top \bP_{\bY,2}^\dagger \bU_2 
    \right)
    \\
    =&
    \frac{1}{\mytr(\bLambda_2)} 
    \mytr\left(\tilde{\bV}_{\bZ_1}^\top \bZ_2^\top 
 \left(
       \bLambda_2^2 
    -\frac{\mytr(\bLambda_2^2)}{\mytr(\bLambda_2)}\bLambda_2
 \right)
\bZ_2 \tilde{\bV}_{\bZ_1}\right)
    \\
           \end{split}
       \end{equation*}
       It is straightforward to show that
       \begin{equation*}
    \myE \mytr\left(\tilde{\bV}_{\bZ_1}^\top \bZ_2^\top 
 \left(
       \bLambda_2^2 
    -\frac{\mytr(\bLambda_2^2)}{\mytr(\bLambda_2)}\bLambda_2
 \right)
\bZ_2 \tilde{\bV}_{\bZ_1}\right)
=0,
       \end{equation*}
       and
       \begin{equation*}
           \begin{split}
    \myVar\left(
        \mytr\left(\tilde{\bV}_{\bZ_1}^\top \bZ_2^\top 
 \left(
       \bLambda_2^2 
    -\frac{\mytr(\bLambda_2^2)}{\mytr(\bLambda_2)}\bLambda_2
 \right)
\bZ_2 \tilde{\bV}_{\bZ_1}\right)
\right)
=&2(n-r)\mytr
 \left(
       \bLambda_2^2 
    -\frac{\mytr(\bLambda_2^2)}{\mytr(\bLambda_2)}\bLambda_2
\right)^2
\\
\leq & 2n \mytr(\bLambda_2^2) (\blambda_{r+1}-\blambda_p)^2
\\
\leq & 2n \blambda_{r+1}\mytr(\bLambda_2) (\blambda_{r+1}-\blambda_p)^2
.
           \end{split}
       \end{equation*}
       Thus,
       \begin{equation*}
        \mytr\left(
            \left(\bLambda_2-\frac{\mytr(\bLambda_2^2)}{\mytr(\bLambda_2)}\bI_{p-r}\right) \bU_2^\top \left(\bP_{\bY,1}^\dagger+\bP_{\bY,2}^\dagger\right) \bU_2 
    \right)
    %=O_P\left(\frac{\sqrt{n\mytr(\bLambda_2^2)}(\blambda_{r+1}-\blambda_p)}{\mytr(\bLambda_2)}\right)
    =O_P\left((\blambda_{r+1}-\blambda_p)\sqrt{\frac{n\blambda_{r+1}}{\mytr(\bLambda_2)}}\right).
       \end{equation*}
       The last display, combined with~\eqref{jojo1}, leads to
\begin{equation*}
        \mytr\left(
            \left(\bLambda_2-\frac{\mytr(\bLambda_2^2)}{\mytr(\bLambda_2)}\bI_{p-r}\right) \bU_2^\top \bP_{\bY} \bU_2 
    \right)
    =
    O_P\left(n(\blambda_{r+1}-\blambda_p)\left(\sqrt{\frac{\mytr(\bLambda_2)\blambda_1}{n\blambda_r^2}}+\sqrt{\frac{n\blambda_{r+1}}{\mytr(\bLambda_2)}}\right)\right).
\end{equation*}
It then follows from~\eqref{jojoa}, \eqref{ranklr} and the last display that
\begin{equation*}
    \begin{split}
        &\mytr\left(
         (\bI_p -\bP_\bY)\bU_2 \bLambda_2 \bU_2^\top (\bI_p- \bP_{\bY})
    \right)
    \\
    =&\mytr(\bLambda_2)-\frac{n\mytr(\bLambda_2^2)}{\mytr(\bLambda_2)}
    +
    O_P\left(n(\blambda_{r+1}-\blambda_p)\left(\sqrt{\frac{\mytr(\bLambda_2)\blambda_1}{n\blambda_r^2}}+\sqrt{\frac{n\blambda_{r+1}}{\mytr(\bLambda_2)}}\right)
    +r\blambda_{r+1}
    \right).
    \end{split}
\end{equation*}
Then the conclusion follows from~\eqref{jojo2} and the last display.
\end{proof}

\begin{lemma}\label{gg:Lemma2}
    Suppose $p>n$, we have
    \begin{equation*}
        \sum_{i=r+1}^{p}\lambda_i^2\left(
         (\bI_p -\bP_\bY)\bSigma (\bI_p- \bP_{\bY})
    \right)
        =
    \mytr(\bLambda_2^2)-\frac{n\mytr^2(\bLambda_2^2)}{\mytr^2(\bLambda_2)}
 +
O_P\left(n\blambda_{r+1}(\blambda_{r+1}-\blambda_p)+r \blambda_{r+1}^2\right).
    \end{equation*}
\end{lemma}
\begin{proof}
    From~\eqref{yanyan1} and~\eqref{yanyan2}, we have
    \begin{equation}\label{jojo100}
        \begin{split}
        &\left|
        \sum_{i=r+1}^{p}\lambda_i^2\left(
         (\bI_p -\bP_\bY)\bSigma (\bI_p- \bP_{\bY})
    \right)
    -
        \mytr\left(
         (\bI_p -\bP_\bY)\bU_2 \bLambda_2 \bU_2^\top (\bI_p- \bP_{\bY})
    \right)^2
    \right|
    \\
    \leq&
    r\lambda_1^2 \left(
         (\bI_p -\bP_\bY)\bU_2 \bLambda_2 \bU_2^\top (\bI_p- \bP_{\bY})
    \right)
    \\
    \leq & r \blambda_{r+1}^2.
        \end{split}
    \end{equation}
    It is straightforward to show that
    \begin{equation*}
        \mytr\left(
         (\bI_p -\bP_\bY)\bU_2 \bLambda_2 \bU_2^\top (\bI_p- \bP_{\bY})
    \right)^2
    =
    \mytr(\bLambda_2^2)
    -2\mytr(\bLambda_2^2 \bU_2^\top \bP_\bY \bU_2)
    + \mytr(\bLambda_2 \bU_2^\top \bP_\bY \bU_2)^2.
    \end{equation*}
    For the second term, we have
    \begin{equation*}
        \begin{split}
        \left|
 \mytr(\bLambda_2^2 \bU_2^\top \bP_\bY \bU_2)
 -
 \frac{\mytr^2(\bLambda_2^2)}{\mytr^2(\bLambda_2)}\mytr( \bU_2^\top \bP_\bY \bU_2)
 \right|
        =&\left|
        \mytr\left(\left(\bLambda_2^2-\frac{\mytr^2(\bLambda_2^2)}{\mytr^2(\bLambda_2)}\bI_{p-r}\right)  \bU_2^\top \bP_\bY \bU_2\right)
 \right|
 \\
 \leq &
 n\blambda_{r+1}(\blambda_{r+1}-\blambda_p),
        \end{split}
    \end{equation*}
    where the last equality follows from von Neumann's trace theorem.
    The last display, combined with~\eqref{ranklr}, implies that
    \begin{equation*}
 \mytr(\bLambda_2^2 \bU_2^\top \bP_\bY \bU_2)
 =
\frac{n\mytr^2(\bLambda_2^2)}{\mytr^2(\bLambda_2)}
+
O_P\left(n\blambda_{r+1}(\blambda_{r+1}-\blambda_p)+r \blambda_{r+1}^2\right).
    \end{equation*}
    For the third term, von Neumann's trace theorem implies that
    \begin{equation*}
        \begin{split}
     &\left|
     \mytr(\bLambda_2 \bU_2^\top \bP_\bY \bU_2)^2
 -
 \frac{\mytr^2(\bLambda_2^2)}{\mytr^2(\bLambda_2)}\mytr( \bU_2^\top \bP_\bY \bU_2)^2
 \right|
 \\
 =
     &\left|
\mytr\left(
\left(\bLambda_2-\frac{\mytr(\bLambda_2^2)}{\mytr(\bLambda_2)}\bI_{p-r}\right) \bU_2^\top \bP_\bY \bU_2
\left(\bLambda_2+\frac{\mytr(\bLambda_2^2)}{\mytr(\bLambda_2)}\bI_{p-r}\right) \bU_2^\top \bP_\bY \bU_2
\right)
 \right|
 \\
 \leq & 2n \blambda_{r+1}(\blambda_{r+1}-\blambda_p).
        \end{split}
    \end{equation*}
    Note that
    \begin{equation*}
        \begin{split}
        \mytr( \bU_2^\top \bP_\bY \bU_2)^2
        =&\mytr\left( \bP_\bY - \bP_\bY\bU_1\bU_1^\top \right)^2
        \\
        =& n- 2\mytr(\bP_\bY\bU_1\bU_1^\top)
        +\mytr(\bP_\bY\bU_1\bU_1^\top)^2
        \\
        =& n+O_P(r)
        .
        \end{split}
    \end{equation*}
    Therefore, the third term satisfies
    \begin{equation*}
     \mytr(\bLambda_2 \bU_2^\top \bP_\bY \bU_2)^2
 =
 \frac{n\mytr^2(\bLambda_2^2)}{\mytr^2(\bLambda_2)}
 +
O_P\left(n\blambda_{r+1}(\blambda_{r+1}-\blambda_p)+r \blambda_{r+1}^2\right).
    \end{equation*}
    Thus,
    \begin{equation*}
        \mytr\left(
         (\bI_p -\bP_\bY)\bU_2 \bLambda_2 \bU_2^\top (\bI_p- \bP_{\bY})
    \right)^2
    =
    \mytr(\bLambda_2^2)-\frac{n\mytr^2(\bLambda_2^2)}{\mytr^2(\bLambda_2)}
 +
O_P\left(n\blambda_{r+1}(\blambda_{r+1}-\blambda_p)+r \blambda_{r+1}^2\right).
    \end{equation*}
    Then the conclusion follows from the last display and~\eqref{jojo100}.
\end{proof}

\begin{proof}[\textbf{Proof of Theorem~\ref{thm1}}]
    We have
    \begin{equation*}
        \begin{split}
&\bZ^{\dagger \top} \bLambda^{1/2}\bU^\top (\bI_p-\bP_{\bY})\bU\bLambda^{1/2}\bZ^{\dagger}
\\
=&
\sum_{i=1}^r \lambda_i ( (\bI_p-\bP_{\bY})\bSigma (\bI_p-\bP_{\bY}))\eta_i \eta_i^\top
+
\sum_{i=r+1}^p \lambda_i ( (\bI_p-\bP_{\bY})\bSigma (\bI_p-\bP_{\bY}))\eta_i \eta_i^\top.
        \end{split}
    \end{equation*}
    From Lemma~\ref{gg:Lemma1}, the first term satisfies
    \begin{equation*}
\sum_{i=1}^r \lambda_i ( (\bI_p-\bP_{\bY})\bSigma (\bI_p-\bP_{\bY}))\eta_i \eta_i^\top
=
(1+o_P(r^{-1/2}))n^{-1}\mytr(\bLambda_2)\sum_{i=1}^r \eta_i \eta_i^\top.
    \end{equation*}
    Then
    \begin{equation}\label{lushang1}
        \frac{
\sum_{i=1}^r \lambda_i ( (\bI_p-\bP_{\bY})\bSigma (\bI_p-\bP_{\bY}))\eta_i \eta_i^\top
-rn^{-1}\mytr(\bLambda_2)\bI_{k-1}
}{
    \sqrt r n^{-1}\mytr(\bLambda_2)
}
=\frac{\sum_{i=1}^r \eta_i \eta_i^\top- r\bI_{k-1}}{\sqrt r}
+o_P(1).
    \end{equation}


    Next we deal with the term
    $
\sum_{i=r+1}^p \lambda_i ( (\bI_p-\bP_{\bY})\bSigma (\bI_p-\bP_{\bY}))\eta_i \eta_i^\top
$.
In the current context, Lemma \ref{gg:Lemmac} and Lemma \ref{gg:Lemma2} imply that
\begin{align}
        &\sum_{i=r+1}^{p}\lambda_i\left(
         (\bI_p -\bP_\bY)\bSigma (\bI_p- \bP_{\bY})
    \right)
    =\mytr(\bLambda_2)-\frac{n\mytr(\bLambda_2^2)}{\mytr(\bLambda_2)}
    +
    o_P\left(
        \sqrt{\mytr(\bLambda_2^2)}
    \right),
    \label{final1}
    \\
        &\sum_{i=r+1}^{p}\lambda_i^2\left(
         (\bI_p -\bP_\bY)\bSigma (\bI_p- \bP_{\bY})
    \right)
        =
        (1+o_P(1))\mytr(\bLambda_2^2).
        \label{final2}
\end{align}
By Weyl's inequality, we have
\begin{equation*}
    \begin{split}
    &\lambda_{r+1} ( (\bI_p-\bP_{\bY})\bSigma (\bI_p-\bP_{\bY}))
    \\
    =&
    \lambda_{r+1} \left( (\bI_p-\bP_{\bY})\bU_1 \bLambda_1 \bU_1^\top (\bI_p-\bP_{\bY})
        +
     (\bI_p-\bP_{\bY})\bU_2 \bLambda_2 \bU_2^\top (\bI_p-\bP_{\bY})\right)
     \\
     \leq&
     \lambda_{1}\left((\bI_p-\bP_{\bY})\bU_2 \bLambda_2 \bU_2^\top (\bI_p-\bP_{\bY})\right)
     \\
     \leq& \blambda_{r+1}.
    \end{split}
\end{equation*}
The last display and \eqref{final1} imply that
$$
\frac{\lambda_{r+1}^2\left((\bI_p-\bP_{\bY})\bU_2 \bLambda_2 \bU_2^\top (\bI_p-\bP_{\bY})\right)}{\sum_{i=r+1}^p\lambda_{i}^2\left((\bI_p-\bP_{\bY})\bU_2 \bLambda_2 \bU_2^\top (\bI_p-\bP_{\bY})\right)}
\leq
\frac{
    \blambda_{r+1}^2
}{
    (1+o_P(1))\mytr(\bLambda_2^2)
}
\xrightarrow{P} 0.
$$
Then Lemma \ref{CLTLEMMA} implies that
\begin{equation*}
    \frac{
\sum_{i=r+1}^p \lambda_i ( (\bI_p-\bP_{\bY})\bSigma (\bI_p-\bP_{\bY}))\eta_i \eta_i^\top
-
\sum_{i=r+1}^p \lambda_i ( (\bI_p-\bP_{\bY})\bSigma (\bI_p-\bP_{\bY})) \bI_{k-1}
}{
    \sqrt{\sum_{i=r+1}^p \lambda_i^2 ( (\bI_p-\bP_{\bY})\bSigma (\bI_p-\bP_{\bY}))}
}
\xrightarrow{\mathcal{L}} \bW_{k-1}.
\end{equation*}
The last display,  combined with \eqref{final1} and \eqref{final2}, leads to
\begin{equation}\label{lushang2}
    \frac{
\sum_{i=r+1}^p \lambda_i ( (\bI_p-\bP_{\bY})\bSigma (\bI_p-\bP_{\bY}))\eta_i \eta_i^\top
-
\left(\mytr(\bLambda_2)-n\mytr(\bLambda_2^2)/\mytr(\bLambda_2)\right)\bI_{k-1}
}{
    \sqrt{\mytr(\bLambda_2^2)}
}
\xrightarrow{\mathcal{L}} \bW_{k-1}.
\end{equation}

Note that $\sum_{i=1}^r \eta_i \eta_i^\top$ is independent of $
\sum_{i=r+1}^p \lambda_i ( (\bI_p-\bP_{\bY})\bSigma (\bI_p-\bP_{\bY}))\eta_i \eta_i^\top
$.
Then\eqref{lushang1} and \eqref{lushang2} implies that
\begin{equation}\label{lushang3}
    \begin{split}
&
\frac{
    \bZ^{\dagger \top} \bLambda^{1/2}\bU^\top (\bI_p-\bP_{\bY})\bU\bLambda^{1/2}\bZ^{\dagger}
    -
    \left((1+r/n)\mytr(\bLambda_2)-n\mytr(\bLambda_2^2)/\mytr(\bLambda_2)\right)\bI_{k-1}
}{
    \sqrt{
        rn^{-2}\mytr^2(\bLambda_2)+ 
        \mytr(\bLambda_2^2)
    }
}
\\
\sim&
\frac{
    n^{-1} \mytr(\bLambda_2)
}{
    \sqrt{
        rn^{-2} \mytr^2 (\bLambda_2) + \mytr(\bLambda_2^2)
    }
}
(\bW_{k-1}^* - r\bI_{k-1})
+
\frac{
    \sqrt{\mytr(\bLambda_2^2)}
}{
    \sqrt{
        rn^{-2} \mytr^2 (\bLambda_2) + \mytr(\bLambda_2^2)
    }
}
\bW_{k-1}
+o_P(1).
    \end{split}
\end{equation}
This completes the proof of the first statement.

Now we prove the second statement.
For the second term of~\eqref{eq:maindec}, we have
$
    \bC^\top \bTheta^\top (\bI_p-\bP_\bY)\bTheta \bC=
    \bC^\top \bTheta^\top\bTheta \bC -
    \bC^\top \bTheta^\top \bP_{\bY} \bTheta \bC
    $.
    We need to deal with
    $
    \bC^\top \bTheta^\top \bP_{\bY} \bTheta \bC
    $.
    Note that Proposition \ref{newEigenvectorPropCor} implies that
    \begin{equation*}
\left\| \bP_{\bY,1}-\bU_1\bU_1^\top\right\|
\leq
\left\| \bP_{\bY,1}-\bP_{\bY,1}^\dagger\right\|+2\left\|\bQ\right\|=o_P(1)
.
    \end{equation*}
    It follows from the last display and Proposition \ref{eigenvectorprop3} that
    \begin{equation*}
        \begin{split}
        &\left\|
        \bC^\top \bTheta^\top \bP_{\bY} \bTheta \bC
        -
        \bC^\top \bTheta^\top \bU_1 \bU_1^\top \bTheta \bC
        -
        \bC^\top \bTheta^\top \bP_{\bY,2}^\dagger \bTheta \bC
        \right\|
        \\
        \leq
        &
        \left\|
        \bC^\top \bTheta^\top \bP_{\bY,1} \bTheta \bC
        -
        \bC^\top \bTheta^\top \bU_1 \bU_1^\top  \bTheta \bC
        \right\|
        +
        \left\|
        \bC^\top \bTheta^\top \bP_{\bY,2} \bTheta \bC
        -
        \bC^\top \bTheta^\top \bP_{\bY,2}^\dagger \bTheta \bC
        \right\|
        \\
        \leq &
\left\|
        \bC^\top \bTheta^\top \bTheta \bC
\right\|
\left(
\left\| \bP_{\bY,1}-\bU_1\bU_1^\top\right\|
    +
    \left\| \bP_{\bY,2}-\bP_{\bY,2}^\dagger\right\|
\right)
\\
=&
o_P\left(
\sqrt{
        rn^{-2} \mytr^2 (\bLambda_2) + \mytr(\bLambda_2^2)
}
\right).
        \end{split}
    \end{equation*}
    We have
\begin{equation*}
        \bC^\top \bTheta^\top \bP_{\bY,2}^\dagger \bTheta \bC
        =
        \left(\mytr(\bLambda_2)\right)^{-1}
        \bC^\top \bTheta^\top \bU_2 \bLambda_2^{1/2} \bZ_{2} \tilde{\bV}_{\bZ_1}  \tilde{\bV}_{\bZ_1}^\top \bZ_2^\top \bLambda_2^{1/2} \bU_2^\top   \bTheta \bC.
\end{equation*}
Note that $\bZ_{2} \tilde{\bV}_{\bZ_1}$ is a $(p-r) \times (n-r) $ matrix with iid $\mathcal{N}(0,1)$ entries.
Then the columns of $\bC^\top \bTheta^\top \bU_2 \bLambda_2^{1/2} \bZ_{2} \tilde{\bV}_{\bZ_1}$ are iid $\mathcal{N}_{k-1}(\mathbf{0}_{k-1},\bC^\top \bTheta^\top \bU_2 \bLambda_2 \bU_2^\top \bTheta \bC)$ random vectors.
Write $\bC^\top \bTheta^\top \bU_2 \bLambda_2^{1/2} \bZ_{2} \tilde{\bV}_{\bZ_1}=(\bC^\top \bTheta^\top \bU_2 \bLambda_2 \bU_2^\top \bTheta \bC)^{1/2} \bZ^*$, where $\bZ^*$ is a $(k-1)\times (n-r)$ random matrix with iid $\mathcal{N}(0,1)$ entries. 
Then
\begin{equation*}
    \begin{split}
        &\left\|
        \bC^\top \bTheta^\top \bP_{\bY,2}^\dagger \bTheta \bC
        -
        \frac{n}{\mytr(\bLambda_2)}\bC^\top \bTheta^\top \bU_{2}\bLambda_2\bU_{2}^\top \bTheta \bC
        \right\|
        \\
        \leq &
        \frac{n}{\mytr(\bLambda_2)}\left\|\bC^\top \bTheta^\top \bU_{2}\bLambda_2\bU_{2}^\top \bTheta \bC
        \right\|
        \left\|
        n^{-1}\bZ^*\bZ^{*\top}-\bI_{k-1}
        \right\|
        \\
=&    
o_P\left(
\sqrt{
        rn^{-2} \mytr^2 (\bLambda_2) + \mytr(\bLambda_2^2)
}
\right)
    ,
    \end{split}
\end{equation*}
where the last equality follows from the law of large numbers, the local alternative condition and the condition $n\blambda_{r+1}/\mytr(\bLambda_2)\to 0$.
But
\begin{equation*}
\frac{n}{\mytr(\bLambda_2)}
        \left\|
        \bC^\top \bTheta^\top \bU_{2}\bLambda_2\bU_{2}^\top \bTheta \bC
        \right\|
        \leq
\frac{n\blambda_2}{\mytr(\bLambda_2)}
        \left\|
        \bC^\top \bTheta^\top  \bTheta \bC
        \right\|
        =
o_P\left(
\sqrt{
        rn^{-2} \mytr^2 (\bLambda_2) + \mytr(\bLambda_2^2)
}
\right).
\end{equation*}
Hence
        $\left\|\bC^\top \bTheta^\top \bP_{\bY,2}^\dagger \bTheta \bC\right\|=
o_P\left(
\sqrt{
        rn^{-2} \mytr^2 (\bLambda_2) + \mytr(\bLambda_2^2)
}
\right)$.
Consequently, 
$
\left\|\bC^\top \bTheta^\top \bP_{\bY} \bTheta \bC-\bC^\top \bTheta^\top \bU_1\bU_1^\top \bTheta \bC\right\|=
o_P\left(
\sqrt{
        rn^{-2} \mytr^2 (\bLambda_2) + \mytr(\bLambda_2^2)
}
\right)
$.
Thus, the second term of~\eqref{eq:maindec} satisfies
\begin{equation}\label{lushang5}
        \left\|
\bC^\top \bTheta^\top (\bI_p-\bP_\bY)\bTheta \bC
        -
        \bC^\top \bTheta^\top \bU_2 \bU_2^\top \bTheta \bC
        \right\|
        =
o_P\left(
\sqrt{
        rn^{-2} \mytr^2 (\bLambda_2) + \mytr(\bLambda_2^2)
}
\right).
\end{equation}




Next we consider the cross term of~\eqref{eq:maindec}. Note that
$$
\begin{aligned}
    & \myE [\|\bC^\top \bTheta^\top (\bI_p -\bP_{\bY})\bU\bLambda^{1/2}\bZ^\dagger\|_F^2|\bY]
    \\
    = &
    (k-1)\mytr(\bC^\top \bTheta^\top (\bI_p -\bP_{\bY})\bSigma (\bI_p -\bP_{\bY})\bTheta \bC)\\
    \leq &
    (k-1)
    \lambda_1\left((\bI_p -\bP_{\bY})\bSigma (\bI_p -\bP_{\bY})\right)
    \mytr(\bC^\top \bTheta^\top  \bTheta \bC)\\
    =&
    O_P\left(
    n^{-1}\mytr(\bLambda_2)
    \left\|\bC^\top \bTheta^\top  \bTheta \bC\right\|
\right),
\end{aligned}
$$
where the last equality follows from Lemma \ref{gg:Lemma1}.
Under the condition $r\to \infty$ or $\mytr(\bLambda_2)/(n \sqrt{\mytr(\bLambda_2^2)})\to 0$, we have
$n^{-1}\mytr(\bLambda_2)=o_P\left(\sqrt{
        rn^{-2} \mytr^2 (\bLambda_2) + \mytr(\bLambda_2^2)
}\right)$.
Therefore,
\begin{equation*}
\|\bC^\top \bTheta^\top (\bI_p -\bP_{\bY})\bU\bLambda^{1/2}\bZ^\dagger\|=
o_P\left(
\sqrt{
        rn^{-2} \mytr^2 (\bLambda_2) + \mytr(\bLambda_2^2)
}
\right)
.
\end{equation*}
It follows from the last display, \eqref{lushang5} and Weyl's inequality that
\begin{equation*}
    \begin{split}
    &\left|
    T(\bX)
    -
    \lambda_1\left(
        \bZ^{\dagger\top} \bLambda^{1/2} \bU^\dagger (\bI_p-\bP_\bY) \bU \bLambda^{1/2} \bZ^\dagger 
        +
        \bC^\top \bTheta^\top \bU_2 \bU_2^\top \bTheta \bC
    \right)
    \right|
    \\
    =&
o_P\left(
\sqrt{
        rn^{-2} \mytr^2 (\bLambda_2) + \mytr(\bLambda_2^2)
}
\right).
    \end{split}
\end{equation*}
Then the second statement follows from the last display and \eqref{lushang3}.

\end{proof}
\begin{proof}[\textbf{Proof of Corollary~\ref{kuCor2}}]
    From Proposition \ref{eigenvalueProp:R3},
    we have
    $$
rn^{-2} (\widehat{\mytr ( \bLambda_2 )})^2 +\widehat{\mytr(\bLambda_2^2)}
=
(1+o_P(1))(rn^{-2} \mytr^2 ( \bLambda_2 ) + \mytr(\bLambda_2^2)),
    $$
    and
    \begin{equation*}
        \begin{split}
    &(1+r/n)\widehat{\mytr(\bLambda_2)}-n\widehat{\mytr(\bLambda_2^2)}/\widehat{\mytr(\bLambda_2)}
    \\
    =&(1+r/n)\mytr(\bLambda_2)
    +O_P\left(r\sqrt{\frac{\mytr(\bLambda_2^2)}{n}}+r\blambda_{r+1}\right)
    \\
    &-\frac{n\mytr(\bLambda_2^2)\left(1+O_P\left(r/n +{r\blambda_{r+1}^2}/{\mytr(\bLambda_2^2)}\right)\right)}
    {\mytr(\bLambda_2)\left(1+O_P\left(r\sqrt{\mytr(\bLambda_2^2)/n\mytr^2(\bLambda_2)}+r\blambda_{r+1}/\mytr(\bLambda_2)\right)\right)}
    \\
    =&(1+r/n)\mytr(\bLambda_2)
    +O_P\left(r\sqrt{\frac{\mytr(\bLambda_2^2)}{n}}+r\blambda_{r+1}\right)
    \\
    &-\frac{n\mytr(\bLambda_2^2)}{\mytr(\bLambda_2)}
\left(1+O_P\left(\frac r n +\frac{r\blambda_{r+1}^2}{\mytr(\bLambda_2^2)}
+r\sqrt{\frac{\mytr(\bLambda_2^2)}{n\mytr^2(\bLambda_2)}}+\frac{r\blambda_{r+1}}{\mytr(\bLambda_2)}\right)\right)
\\
    =&(1+r/n)\mytr(\bLambda_2)-\frac{n\mytr(\bLambda_2^2)}{\mytr(\bLambda_2)}
    +o_P\left(\sqrt{\mytr(\bLambda_2^2)}\right).
        \end{split}
    \end{equation*}
Therefore,
    \begin{equation*}
        Q_2=
\frac{
    T(\bX)
    -
    \left((1+r/n)\mytr(\bLambda_2)-n\mytr(\bLambda_2^2)/\mytr(\bLambda_2)\right)
}{
    \sqrt{
        rn^{-2}\mytr^2(\bLambda_2)+ 
        \mytr(\bLambda_2^2)
    }
}
+o_P(1).
    \end{equation*}
    On the other hand,
    it is not hard to see that the ratio consistency of $\widehat{\mytr(\blambda_2)}$ and $\widehat{\mytr(\bLambda_2^2)}$ imply
     $F_2^{-1}(1-\alpha;\widehat{\mytr(\bLambda_2)},\widehat{\mytr(\bLambda_2^2)})=F_2^{-1}(1-\alpha;\mytr(\bLambda_2),\mytr(\bLambda_2^2))+o_P(1)$.
     Then the conclusion follows from Theorem \ref{thm1} and Slutsky's theorem.
\end{proof}

\begin{proof}[\textbf{Proof of Proposition~\ref{numberConsistency}}]
    Under the conditions of Theorem \ref{fenTheorem1}, we have
    $n\blambda_1/\mytr(\bSigma)\to 0$.
    From Lemma \ref{lemma:con} and Weyl's inequality, we have
    \begin{equation*}
        \lambda_1(\hat \bSigma) 
        =
        n^{-1}\lambda_1(\bZ^\top \bLambda \bZ) 
        =
        n^{-1}\mytr( \bSigma ) +O_P\left(\sqrt{\frac{\mytr(\bSigma^2)}{n}}+\blambda_1\right)
        =
        (1+o_P(1)) n^{-1}\mytr( \bSigma ) 
        .
    \end{equation*}
    From the proof of Corollary \ref{kuCor1}, we have $\mytr(\hat{\bSigma})=(1+o_P(1))\mytr(\bSigma)$.
    Therefore,
\begin{equation*}
    \frac{
        n\lambda_1(\hat{\bSigma})
    }{
\mytr(\hat{\bSigma})}
\xrightarrow{P}1.
\end{equation*}
This completes the proof of (i).

Now we prove (ii).
Under the conditions of Theorem \ref{thm1}, 
Proposition \ref{eigenvalueProp} implies that
\begin{equation*}
\begin{split}
    \frac{
        n\lambda_1(\hat{\bSigma})
    }{
\mytr(\hat{\bSigma})}
=&
    \frac{
        n\lambda_1(\hat{\bSigma})
    }{
    \sum_{i=1}^r \lambda_i(\hat{\bSigma})
    +
    \sum_{i=r+1}^n \lambda_i(\hat{\bSigma})
}
\\
=&
        (1+o_P(1))
    \frac{
        n\blambda_1+ \mytr(\bLambda_2)
    }{
        \sum_{i=1}^r \blambda_i+ \mytr(\bLambda_2)
}
\\
\geq
&
        (1+o_P(1))
    \frac{
        n\blambda_1
    }{
        r \blambda_1+ \mytr(\bLambda_2)
}
\xrightarrow{P}\infty.
\end{split}
\end{equation*}
It follows that
    \begin{equation*}
        \Pr\left(
    \frac{
        n\lambda_1(\hat{\bSigma})
    }{
    \mytr(\hat{\bSigma})}
<\tau
\right)\to 0
.
    \end{equation*}
Next we consider the consistency of $\hat r $.
Note that
    $$
    \{\hat{r}=r\}=
    \left\{  
    \frac{
        n\lambda_{i+1}(\hat{\bSigma})
}
{    
    \sum_{j=i+1}^n
\lambda_j(\hat{\bSigma})}
    \geq \tau, i=1,\ldots, r-1 \right\}
    \cap
    \left\{
    \frac{
        n\lambda_{r+1}(\hat{\bSigma})
}
{    
    \sum_{j=r+1}^n
\lambda_j(\hat{\bSigma})}
    < \tau \right\}.
    $$
    But Proposition \ref{eigenvalueProp} implies that uniformly for $i=1,\ldots, r-1$,
    \begin{equation*}
        \begin{split}
    \frac{
        n\lambda_{i+1}(\hat{\bSigma})
}
{    
    \sum_{j=i+1}^n
\lambda_j(\hat{\bSigma})}
\geq
&
    \frac{
        n\lambda_{i+1}(\hat{\bSigma})
}
{
    (r-i)\lambda_{i+1}(\hat{\bSigma})    
    +
    \sum_{j=r+1}^n
\lambda_j(\hat{\bSigma})}
\\
=&
(1+o_P(1))
\frac{
    n\blambda_{i+1}+\mytr(\bLambda_2)
}{
    (r-i) \blambda_{i+1}+ (1-i/n) \mytr(\bLambda_2)
}\xrightarrow{P} \infty.
        \end{split}
    \end{equation*}
    Thus, we only need to prove that
    \begin{equation*}
    \Pr
    \left(
    \frac{
        n\lambda_{r+1}(\hat{\bSigma})
}
{    
    \sum_{j=r+1}^n
\lambda_j(\hat{\bSigma})}
    < \tau \right)\to 1.
    \end{equation*}
    Weyl' inequality implies that $n\lambda_{r+1}(\hat{\bSigma})=\lambda_{r+1}(\bZ_1^\top \bLambda_1 \bZ_1+\bZ_2^\top \bLambda_2 \bZ_2)
    \leq \lambda_1(\bZ_2^\top \bLambda_2 \bZ_2).
    $
    Then using Lemma \ref{lemma:con}, we have $n\lambda_{r+1}(\hat \bSigma)\leq (1+o_P(1)) \mytr(\bLambda_2)$.
    Thus,
    \begin{equation*}
    \frac{
        n\lambda_{r+1}(\hat{\bSigma})
}
{    
    \sum_{j=r+1}^n
\lambda_j(\hat{\bSigma})}
\leq
(1+o_P(1))
.
    \end{equation*}
    This completes the proof.

\end{proof}


\bibliographystyle{chicago}      % Chicago style, author-year citations
\bibliography{mybibfile}   % name your BibTeX data base

\end{document}
